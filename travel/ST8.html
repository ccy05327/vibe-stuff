<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¦™æ¸¯8æ—¥è‡ªç”±è¡Œä¼åŠƒæ›¸ (æœ€çµ‚ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Serene Neutrals -->
    <!-- Application Structure Plan: A single-page application (SPA) with a fixed top navigation bar for seamless switching between content sections (è¡Œç¨‹ç¸½è¦½, æ¯æ—¥è¡Œç¨‹, ç¾é£Ÿåœ°åœ–, è¡Œå‰æº–å‚™). This structure is chosen for clarity, allowing the user to access all key information without reloading. 'è¡Œç¨‹ç¸½è¦½' acts as a dashboard with key facts and a transportation cost/time chart. 'æ¯æ—¥è¡Œç¨‹' uses a vertical timeline for a clear chronological flow, now updated with budget constraints. 'ç¾é£Ÿåœ°åœ–' is a filterable grid for easy discovery of affordable eats mentioned in the source report. 'è¡Œå‰æº–å‚™' is a practical checklist based on the report's advice. This component-based design makes the dense travel plan digestible and easy to navigate. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Airport to Kwun Tong transport options. Goal: Compare cost and time. Viz: Grouped Bar Chart (Chart.js). Interaction: Tooltips on hover provide exact figures. Justification: A bar chart offers a direct, easily understood visual comparison of quantitative data. Library: Chart.js (Canvas).
        - Report Info: Daily schedule with budget constraints. Goal: Organize sequential activities with transparent costs. Presentation: Vertical Timeline (HTML/Tailwind). Interaction: Clickable map links. Details include explicit transport fares and attraction prices (mostly 'Free'). Justification: The timeline is the most intuitive way to present a chronological itinerary, and adding explicit costs directly addresses the user's primary request for budget control.
        - Report Info: Budget-friendly restaurant mentions. Goal: Organize and filter food choices. Presentation: Card-based Grid (HTML/Tailwind). Interaction: Category filter buttons (JS). Justification: A filterable grid allows users to quickly find affordable, recommended meals based on type, enhancing the flexible travel style.
        - Report Info: Pre-trip advice. Goal: Inform and prepare the traveler. Presentation: Checklist with Unicode icons (HTML). Justification: A simple list is most effective for actionable items like getting an Octopus card and understanding etiquette.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #F8F7F4;
            color: #3E4E50;
        }
        :root {
            --bg-color: #F8F7F4;
            --text-color: #3E4E50;
            --primary-accent: #6B7A8F;
            --secondary-accent: #D5A08C;
            --card-bg: #FFFFFF;
            --border-color: #E0E0E0;
        }
        .nav-link {
            transition: color 0.3s, border-bottom-color 0.3s;
            border-bottom: 2px solid transparent;
        }
        .nav-link.active {
            color: var(--primary-accent);
            border-bottom-color: var(--primary-accent);
            font-weight: 700;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            top: 1.25rem;
            left: -0.4rem;
            width: 0.8rem;
            height: 0.8rem;
            background-color: var(--secondary-accent);
            border: 2px solid var(--card-bg);
            border-radius: 50%;
            z-index: 1;
        }
        .timeline-connector {
            position: absolute;
            top: 1.25rem;
            left: 0;
            bottom: 0;
            width: 2px;
            background-color: var(--border-color);
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        /* Gemini Modal */
        #gemini-modal {
            transition: opacity 0.3s ease;
        }
        .gemini-btn {
            background-color: var(--primary-accent);
            color: white;
            padding: 6px 12px;
            border-radius: 9999px;
            font-weight: 500;
            transition: all 0.2s;
            font-size: 0.875rem;
        }
         .gemini-btn:hover {
            opacity: 0.9;
        }
        .gemini-info-btn {
             background-color: transparent;
             color: var(--secondary-accent);
             border: 1px solid var(--secondary-accent);
             padding: 2px 8px;
             border-radius: 9999px;
             font-size: 0.75rem;
             margin-left: 8px;
        }
         .gemini-info-btn:hover {
            background-color: rgba(213, 160, 140, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">

    <div id="app" class="container mx-auto max-w-7xl p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-bold text-[color:var(--primary-accent)]">é¦™æ¸¯8æ—¥è‡ªç”±è¡Œ (æœ€çµ‚ç‰ˆ)</h1>
            <p class="text-lg text-gray-600 mt-2">ç‚ºæ‚¨é‡èº«æ‰“é€ çš„æ·±åº¦æ¢ç´¢ä¹‹æ—…</p>
        </header>

        <nav id="main-nav" class="sticky top-0 z-20 bg-[color:var(--bg-color)]/80 backdrop-blur-sm mb-8 py-2 border-b border-[color:var(--border-color)]">
            <div class="flex justify-center items-center space-x-4 sm:space-x-8 text-sm sm:text-base flex-wrap">
                <button data-target="overview" class="nav-link p-2">è¡Œç¨‹ç¸½è¦½</button>
                <button data-target="daily-itinerary" class="nav-link p-2">æ¯æ—¥è¡Œç¨‹</button>
                <button data-target="food-map" class="nav-link p-2">ç¾é£Ÿåœ°åœ–</button>
                <button data-target="preparation" class="nav-link p-2">è¡Œå‰æº–å‚™</button>
            </div>
        </nav>

        <main id="content-container">
            <!-- Sections will be here -->
            <section id="overview" class="content-section">
                <div class="bg-[color:var(--card-bg)] p-6 rounded-xl shadow-sm">
                    <h2 class="text-2xl font-bold text-[color:var(--primary-accent)] mb-4">æ—…ç¨‹æ ¸å¿ƒè³‡è¨Š</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <h3 class="font-semibold text-lg">âœˆï¸ èˆªç­è³‡è¨Š</h3>
                                <p>å»ç¨‹: 2025/06/18 UO115 (17:40 æ¡ƒåœ’ â†’ 19:35 é¦™æ¸¯)</p>
                                <p>å›ç¨‹: 2025/06/25 UO114 (14:55 é¦™æ¸¯ â†’ 16:45 æ¡ƒåœ’)</p>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg">ğŸ  ä½å®¿è³‡è¨Š</h3>
                                <p>è§€å¡˜æ¸¯éµç«™é™„è¿‘çš„æœ‹å‹å®¶</p>
                            </div>
                            <div>
                                <h3 class="font-semibold text-lg">ğŸ“ è¡Œç¨‹é¢¨æ ¼</h3>
                                <p>éš¨æ€§ã€æ¼«æ­¥ã€äº«å—è‡ªç„¶èˆ‡å»ºç¯‰ï¼Œçµåˆè—æ–‡èˆ‡ç¾é£Ÿçš„æ·±åº¦ä¹‹æ—…ï¼Œåš´æ ¼éµå®ˆé ç®—é™åˆ¶ã€‚</p>
                            </div>
                             <div>
                                <h3 class="font-semibold text-lg">ğŸŒ¦ï¸ å¤©æ°£æé†’ (æ›´æ–°)</h3>
                                <p>æœªä¾†æ•¸æ—¥ç‚ºå…¸å‹å¤å­£å¤©æ°£ï¼šç‚ç†±ã€æ½®æ¿•ï¼Œå¶æœ‰é©Ÿé›¨åŠé›·æš´ã€‚è¡Œç¨‹å·²æ“šæ­¤èª¿æ•´ï¼Œå¢åŠ å½ˆæ€§ã€‚</p>
                            </div>
                        </div>
                        <div>
                            <h3 class="font-semibold text-lg text-center mb-2">æ©Ÿå ´äº¤é€šæ¯”è¼ƒ (å‰å¾€è§€å¡˜)</h3>
                            <div class="chart-container">
                                <canvas id="transportationChart"></canvas>
                            </div>
                            <p class="text-xs text-center text-gray-500 mt-2">æ­¤åœ–è¡¨æ¯”è¼ƒäº†å¾æ©Ÿå ´åˆ°è§€å¡˜çš„å¹¾ç¨®äº¤é€šæ–¹å¼ã€‚æ­ä¹˜åŸå·´A22è·¯ç·šæœ€å…·æ€§åƒ¹æ¯”ï¼Œèƒ½ä»¥æœ€ä½æˆæœ¬åˆ°é”ï¼Œéå¸¸é©åˆé ç®—æœ‰é™çš„æ—…å®¢ã€‚</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="daily-itinerary" class="content-section hidden">
                <div class="flex justify-center flex-wrap gap-2 mb-6" id="day-tabs-container"></div>
                <div id="itinerary-content"></div>
            </section>

            <section id="food-map" class="content-section hidden">
                <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-[color:var(--primary-accent)] mb-2">é¦™æ¸¯å¹³åƒ¹ç¾é£Ÿåœ°åœ–</h2>
                    <p class="text-gray-600">ç‚ºæ‚¨ç²¾é¸ç¬¦åˆé ç®—(æ—¥å‡HKD 100)ä¸”å ±å‘Šä¸­æåŠçš„é“åœ°ç¾é£Ÿï¼Œé»æ“Šåº—åå¯æŸ¥çœ‹åœ°åœ–ã€‚</p>
                    <div id="food-filters" class="mt-4 flex justify-center gap-2 flex-wrap">
                        <button class="food-filter-btn active" data-category="all">å…¨éƒ¨</button>
                        <button class="food-filter-btn" data-category="é»å¿ƒ">é»å¿ƒ</button>
                        <button class="food-filter-btn" data-category="ç²‰éºµ">ç²‰éºµ</button>
                        <button class="food-filter-btn" data-category="èŒ¶é¤å»³">èŒ¶é¤å»³</button>
                        <button class="food-filter-btn" data-category="ç‰¹è‰²å°é£Ÿ">ç‰¹è‰²å°é£Ÿ</button>
                    </div>
                </div>
                <div id="food-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
            </section>

            <section id="preparation" class="content-section hidden">
                <div class="bg-[color:var(--card-bg)] p-6 rounded-xl shadow-sm">
                    <h2 class="text-2xl font-bold text-[color:var(--primary-accent)] mb-4">è¡Œå‰æº–å‚™èˆ‡åœ¨åœ°æ”»ç•¥</h2>
                     <ul class="space-y-4 list-inside">
                        <li class="flex items-start"><span class="mr-3 text-xl">ğŸ™</span><div><strong class="font-semibold">å…«é”é€šå¡ (Octopus Card):</strong><br>éŠæ¸¯å¿…å‚™ã€‚å»ºè­°è³¼è²·æ—…å®¢ç‰ˆï¼Œç„¡éœ€æŠ¼é‡‘ã€‚MTRè»Šç«™ã€ä¾¿åˆ©åº—å‡å¯è³¼è²·èˆ‡å¢å€¼ã€‚æ­ä¹˜äº¤é€šå·¥å…·æ¯”å–®ç¨‹ç¥¨æ›´ä¾¿å®œã€‚</div></li>
                        <li class="flex items-start"><span class="mr-3 text-xl">ğŸš¶â€â™‚ï¸</span><div><strong class="font-semibold">äº¤é€šç¦®å„€:</strong><br>æ‰‹æ‰¶æ¢¯é å³ç«™ç«‹ï¼Œå·¦å´ç‚ºè¡Œèµ°é€šé“ã€‚å…ˆä¸‹å¾Œä¸Šï¼Œé€²å…¥è»Šå»‚å¾Œå¾€ä¸­é–“ç§»å‹•ã€‚å·´å£«åˆ°ç«™å‰éœ€æŒ‰éˆ´ã€‚</div></li>
                        <li class="flex items-start"><span class="mr-3 text-xl">ğŸ¤«</span><div><strong class="font-semibold">å…¬å…±å ´åˆç¦®å„€:</strong><br>è»Šå»‚å…§ä¿æŒå®‰éœï¼Œè«‹å‹¿é£²é£Ÿã€‚å„ªå…ˆå°‡åº§ä½è®“çµ¦æœ‰éœ€è¦çš„äººã€‚</div></li>
                        <li class="flex items-start"><span class="mr-3 text-xl">ğŸ’°</span><div><strong class="font-semibold">å¹³åƒ¹ç¾é£ŸæŒ‡å—:</strong><br>å¤šåŠ åˆ©ç”¨ã€ŒèŒ¶é¤å»³ã€èˆ‡ã€Œå…©é¤¸é£¯ã€ï¼Œå®ƒå€‘æ˜¯é¦™æ¸¯é“åœ°ä¸”ç¶“æ¿Ÿå¯¦æƒ çš„é¸æ“‡ï¼Œèƒ½è®“æ‚¨åœ¨é ç®—å…§å“åšåœ¨åœ°é¢¨å‘³ã€‚</div></li>
                        <li class="flex items-start"><span class="mr-3 text-xl">ğŸ”Œ</span><div><strong class="font-semibold">åŸºæœ¬ç”¨å“:</strong><br>è‹±è¦ä¸‰è§’è½‰æ¥é ­ã€é›¨å…·ã€èˆ’é©çš„é‹å­ã€è–„å¤–å¥— (å®¤å…§å†·æ°£å¼·)ã€å€‹äººè—¥å“ã€‚</div></li>
                    </ul>
                </div>
            </section>
        </main>
    </div>

    <!-- Gemini Modal -->
    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 hidden opacity-0">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="p-4 sm:p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 id="gemini-modal-title" class="text-xl font-bold text-[color:var(--primary-accent)]">âœ¨ AI åŠ©ç†</h3>
                    <button id="gemini-modal-close" class="text-gray-400 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div id="gemini-modal-content" class="text-gray-700">
                    <!-- Content generated by Gemini will be injected here -->
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const itineraryData = {
        "Day 1 (Wed, Jun 18)": [
            { time: '19:35', icon: 'âœˆï¸', title: 'æŠµé”é¦™æ¸¯åœ‹éš›æ©Ÿå ´', duration: 'ç´„1å°æ™‚', transport: 'è¾¦ç†å…¥å¢ƒã€é ˜å–è¡Œæ', details: 'è³¼è²·å…«é”é€šå¡ï¼Œç‚ºæ—…ç¨‹åšå¥½æº–å‚™ã€‚', mapLink: 'https://www.google.com/maps/place/Hong+Kong+International+Airport+(HKG)/' },
            { time: '20:30', icon: 'ğŸšŒ', title: 'å‰å¾€è§€å¡˜', duration: 'ç´„60-75åˆ†é˜', transport: 'æ­ä¹˜åŸå·´A22ï¼Œæ–¼è§€å¡˜å¸‚ä¸­å¿ƒä¸‹è»Š', price: 'HKD 40.80', details: 'é€™æ˜¯å‰å¾€è§€å¡˜æœ€ç¶“æ¿Ÿå¯¦æƒ çš„ç›´é”å·´å£«è·¯ç·šã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=Airport+Ground+Transportation+Centre' },
            { time: '21:45', icon: 'ğŸ ', title: 'æŠµé”æœ‹å‹å®¶ & æ™šé¤', duration: '---', transport: 'æ­¥è¡Œ', details: 'å®‰é “è¡Œæï¼Œå¯åœ¨è§€å¡˜apmå•†å ´æˆ–é™„è¿‘ä¾¿åˆ©åº—ç°¡å–®ç”¨é¤ï¼Œæ—©é»ä¼‘æ¯ã€‚', mapLink: 'https://www.google.com/maps/place/Kwun+Tong+Station/' },
        ],
        "Day 2 (Thu, Jun 19)": [
            { time: '10:00', icon: 'ğŸ›ï¸', title: 'ä¸­ç’°å¤è¹Ÿèˆ‡è—è¡“å€æ¢ç´¢', duration: 'ç´„3å°æ™‚', transport: 'æ¸¯éµ (è§€å¡˜ â†’ ä¸­ç’°) ç´„ HKD 15.50', price: 'å…è²»', details: 'åƒè§€ã€Œå¤§é¤¨ã€ï¼Œç”±å‰ä¸­å€è­¦ç½²å»ºç¯‰ç¾¤æ´»åŒ–è€Œæˆã€‚æ¥è‘—æ­¥è¡Œè‡³ã€ŒPMQå…ƒå‰µæ–¹ã€ï¼Œæ„Ÿå—åœ¨åœ°è¨­è¨ˆå¸«çš„å‰µæ„æ´»åŠ›ã€‚', mapLink: 'https://www.google.com/maps/place/Tai+Kwun' },
            { time: '13:00', icon: 'ğŸœ', title: 'åˆé¤ @ ä¸­ç’°è€å­—è™Ÿ', duration: 'ç´„1å°æ™‚', transport: 'æ­¥è¡Œ', price: 'ç´„ HKD 70-100', details: 'å¯é¸ã€Œä¹è¨˜ç‰›è…©ã€çš„æ¸…æ¹¯ç‰›è…©ï¼Œæˆ–åœ¨ã€Œè˜­èŠ³åœ’ã€å“åšçµ²è¥ªå¥¶èŒ¶èˆ‡è±¬æ‰’åŒ…ã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=Kau+Kee+Restaurant+Central' },
            { time: '15:00', icon: 'ğŸ®', title: 'ä¸Šç’°æ–‡åŒ–æ•£ç­–', duration: 'ç´„2å°æ™‚', transport: 'æ­¥è¡Œ', price: 'å…è²»', details: 'æ²¿è·ææ´»é“å°‹è¨ªå¤è‘£åº—ï¼Œåƒè§€é¦™ç«é¼ç››çš„ã€Œæ–‡æ­¦å»Ÿã€ï¼Œä¸¦åœ¨ä¿—ç¨±ã€Œè²“è¡—ã€çš„æ‘©ç¾…ä¸Šè¡—å°‹å¯¶ã€‚', mapLink: 'https://www.google.com/maps/place/Man+Mo+Temple' },
            { time: '17:00', icon: 'ğŸš', title: 'å®å®è»Šæ¸¯å³¶éŠ', duration: 'ç´„30åˆ†é˜', transport: 'é›»è»Š (å¾€éŠ…é‘¼ç£æ–¹å‘) HKD 3.30', price: 'HKD 3.30', details: 'åä¸Šé›»è»Šä¸Šå±¤ï¼Œä»¥ç·©æ…¢æ­¥èª¿æ¬£è³æ¸¯å³¶çš„è¡—æ™¯ã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=ding+ding+tram+central' },
        ],
        "Day 3 (Fri, Jun 20)": [
            { time: '10:00', icon: 'ğŸ›ï¸', title: 'æ·±æ°´åŸ—å¸‚å ´æ¼«éŠ', duration: 'ç´„3å°æ™‚', transport: 'æ¸¯éµ (è§€å¡˜ â†’ æ·±æ°´åŸ—) ç´„ HKD 11.80', price: 'å…è²»', details: 'æ¢ç´¢é´¨å¯®è¡—(é›»å­ç”¢å“)ã€ç¦æ¦®è¡—(ç©å…·)åŠåŸºéš†è¡—(å¸ƒæ–™)ï¼Œæ„Ÿå—æœ€çœŸå¯¦çš„åœ¨åœ°å¸‚é›†èˆ‡è¡—é ­è—è¡“ã€‚', mapLink: 'https://www.google.com/maps/place/Sham+Shui+Po' },
            { time: '13:00', icon: 'Michelin Star', title: 'åˆé¤ @ æ·»å¥½é‹', duration: 'ç´„1å°æ™‚', transport: 'æ­¥è¡Œ', price: 'ç´„ HKD 60-90', details: 'å“åšå…¨ä¸–ç•Œæœ€å¹³åƒ¹çš„ç±³å…¶æ—ä¸€æ˜Ÿé»å¿ƒã€‚æ¨è–¦ï¼šé…¥çš®ç„—å‰ç‡’åŒ…ã€é¦™æ»‘é¦¬æ‹‰ç³•ã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=Tim+Ho+Wan+Sham+Shui+Po' },
            { time: '15:00', icon: 'ğŸ¬', title: 'æ—ºè§’æ½®æµæ–‡åŒ–æ¢ç´¢', duration: 'ç´„4å°æ™‚', transport: 'æ¸¯éµ (æ·±æ°´åŸ— â†’ æ—ºè§’) ç´„ HKD 5.20', price: 'å…è²»', details: 'å¤©æ°£å¥½å¯é€›é‡‘é­šè¡—ã€å¥³äººè¡—ï¼Œæ„Ÿå—ç†±é¬§è¡—é ­ã€‚å¦‚ä¸‹é›¨ï¼Œå¯èº²é€²å¤§å‹å•†å ´æœ—è±ªåŠï¼Œæˆ–åˆ°æ¨“ä¸Šçš„ç‰¹è‰²å’–å•¡åº—ä¼‘æ¯ã€‚', mapLink: 'https://www.google.com/maps/place/Mong+Kok' },
            { time: '19:00', icon: 'ğŸŒƒ', title: 'æ™šé¤ @ å»Ÿè¡—', duration: 'ç´„1.5å°æ™‚', transport: 'æ¸¯éµ (æ—ºè§’ â†’ æ²¹éº»åœ°) ç´„ HKD 5.20', price: 'ç´„ HKD 70-100', details: 'æ·±å…¥å»Ÿè¡—å¤œå¸‚å‘¨é‚Šçš„é£Ÿè‚†ï¼Œå“åšç…²ä»”é£¯ç­‰å¤§æ’æª”é¢¨å‘³ç¾é£Ÿã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=Temple+Street+Night+Market' }
        ],
        "Day 4 (Sat, Jun 21)": [
             { time: 'ä¸Šåˆ', icon: 'â¤ï¸', title: 'æœ‹å‹æ—¥ (æ—©é¤)', duration: 'ç´„1.5å°æ™‚', transport: 'æ¸¯éµ (è§€å¡˜ â†’ ä½æ•¦) ç´„ HKD 9.50', price: 'ç´„ HKD 50', details: 'èˆ‡æœ‹å‹ç›¸ç´„åœ¨ä½æ•¦ã€Œæ¾³æ´²ç‰›å¥¶å…¬å¸ã€ï¼Œé«”é©—åœ°é“æ¸¯å¼æ—©é¤ã€‚åšå¥½æ’éšŠçš„å¿ƒç†æº–å‚™ï¼', mapLink: 'https://www.google.com/maps/search/?api=1&query=Australia+Dairy+Company' },
             { time: 'ä¸‹åˆ', icon: 'ğŸ¤”', title: 'å½ˆæ€§è¡Œç¨‹ (èˆ‡æœ‹å‹)', duration: '---', transport: '---', price: '---', details: 'æ ¹æ“šå¤©æ°£æ±ºå®šï¼š<br><b>æ™´å¤©å‚™æ¡ˆï¼š</b>æ­å·´å£«åˆ°å—å€çš„èµ¤æŸ±å¸‚é›†ï¼Œäº«å—æµ·é‚Šå°é®çš„æ‚ é–’æ°›åœã€‚<br><b>é›¨å¤©å‚™æ¡ˆï¼š</b>å‰å¾€ä¹é¾å¡˜åˆä¸€åŸï¼Œé€™æ˜¯ä¸€å€‹å¤§å‹å•†å ´ï¼Œæœ‰é›»å½±é™¢ã€æºœå†°å ´å’Œå„ç¨®å•†åº—ï¼Œå¯ä»¥è¼•é¬†åº¦éä¸€å€‹ä¸‹åˆã€‚', mapLink: 'https://www.google.com/maps/place/Hong+Kong' },
        ],
        "Day 5 (Sun, Jun 22)": [
             { time: 'å…¨æ—¥', icon: 'ğŸï¸', title: 'æœ‹å‹æ—¥ (æ˜‚åªé«˜åŸ)', duration: 'ç´„7-8å°æ™‚', transport: 'æ¸¯éµ (è§€å¡˜ â†’ æ±æ¶Œ) ç´„ HKD 24.90', price: 'å·´å£« HKD 74.00 (å‡æ—¥ä¾†å›)', details: 'èˆ‡æœ‹å‹åŒéŠå¤§å¶¼å±±ã€‚æ­ä¹˜æ–°å¤§å¶¼å±±å·´å£«23è™Ÿä¸Šå±±ï¼Œåƒæ‹œå¤©å£‡å¤§ä½›ã€å¯¶è“®ç¦ªå¯ºï¼Œä¸¦åœ¨å¿ƒç¶“ç°¡æ—ä¸­æ¼«æ­¥ã€‚è«‹æ³¨æ„å·´å£«ç­æ¬¡ï¼Œé ç•™å……è¶³æ™‚é–“ä¸‹å±±ã€‚', mapLink: 'https://www.google.com/maps/place/Ngong+Ping' },
        ],
        "Day 6 (Mon, Jun 23)": [
            { time: '10:30', icon: 'ğŸ›ï¸', title: 'é¦™æ¸¯æ–‡åŒ–åšç‰©é¤¨', duration: 'ç´„4å°æ™‚', transport: 'æ¸¯éµ (è§€å¡˜ â†’ å¤§åœ) ç´„ HKD 9.50', price: 'å…è²» (å¸¸è¨­å±•è¦½)', details: 'é¤¨è—è±å¯Œï¼Œé‡‘åº¸é¤¨ã€ç²µåŠ‡æ–‡ç‰©é¤¨åŠé¦™æ¸¯æµè¡Œæ–‡åŒ–å±•éƒ½å€¼å¾—èŠ±æ™‚é–“ç´°çœ‹ï¼Œæ˜¯çµ•ä½³çš„é›¨å¤©å‚™æ¡ˆã€‚', mapLink: 'https://www.google.com/maps/place/Hong+Kong+Heritage+Museum' },
            { time: '15:00', icon: 'ğŸŒ³', title: 'é‘½çŸ³å±±å°‹å¹½', duration: 'ç´„2.5å°æ™‚', transport: 'æ¸¯éµ (å¤§åœ â†’ é‘½çŸ³å±±) ç´„ HKD 5.10', price: 'å…è²»', details: 'åƒè§€ä»¿å”ä»£æœ¨æ§‹å»ºç¯‰çš„ã€Œå¿—è“®æ·¨è‹‘ã€ï¼Œä¸¦åœ¨ç›¸é„°çš„ã€Œå—è“®åœ’æ± ã€ä¸­äº«å—ç‰‡åˆ»å¯§éœã€‚', mapLink: 'https://www.google.com/maps/place/Chi+Lin+Nunnery' },
            { time: '18:00', icon: 'ğŸ‡¹ğŸ‡­', title: 'æ™šé¤ @ ä¹é¾åŸ', duration: 'ç´„2å°æ™‚', transport: 'å·´å£«/å°å·´ (é‘½çŸ³å±± â†’ ä¹é¾åŸ) ç´„ HKD 6', price: 'ç´„ HKD 80-100', details: 'æ¢ç´¢æœ‰ã€Œå°æ³°åœ‹ã€ä¹‹ç¨±çš„ä¹é¾åŸã€‚æ¨è–¦ã€Œæ¨‚åœ’ã€çš„æ²™å—²ç‰›è¥¿å¤šå£«ï¼Œæˆ–ã€Œæ¸…çœŸç‰›è‚‰é¤¨ã€çš„çˆ†æ¼¿ç‰›è‚‰é¤…ã€‚', mapLink: 'https://www.google.com/maps/place/Kowloon+City' },
        ],
        "Day 7 (Tue, Jun 24)": [
            { time: '09:00 - 12:00', icon: 'ğŸ™ï¸', title: 'æ·±æ°´åŸ—çš„æ­·å²èˆ‡å¸‚äº•', duration: 'ç´„3å°æ™‚', transport: 'å¾è§€å¡˜æ­ä¹˜å·´å£« 42 è™Ÿ (ç´„HKD 10.40) åˆ°ã€Œé•·æ²™ç£é“éŠæ¨‚å ´ã€ç«™', price: 'å…è²»', details: 'ç”¨æœ€å……æ²›çš„é«”åŠ›é–‹å§‹ä½ çš„ä¸€å¤©ï¼å…ˆæŒ‘æˆ°ç™»ä¸Šä¸»æ•™å±±ï¼Œæ¢ç´¢ç™¾å¹´ç¾…é¦¬å¼è“„æ°´æ± ï¼Œç„¶å¾Œä¸‹å±±æŠ•å…¥é´¨å¯®è¡—ç­‰å¸‚å ´çš„æ‡·æŠ±ã€‚', mapLink: 'https://www.google.com/maps/place/Shek+Kip+Mei+Fresh+Water+Service+Reservoir' },
            { time: '12:00 - 13:30', icon: 'ğŸ”', title: 'åˆé¤ & å‰å¾€æ¸¯å³¶', duration: 'ç´„1.5å°æ™‚', transport: 'å¾ã€Œæ·±æ°´åŸ—è­¦ç½²ã€ç«™æ­ä¹˜éæµ·å·´å£« 905 è™Ÿ (ç´„HKD 12.10) åˆ°ä¸­ç’°', price: 'ç´„ HKD 30-50', details: 'åœ¨æ·±æ°´åŸ—æˆ–ä¸­ç’°ç”¨éº¥ç•¶å‹å¿«é€Ÿè§£æ±ºåˆé¤ã€‚å·´å£«ä¸Šå±¤æ˜¯æ¬£è³éæµ·é¢¨æ™¯çš„æœ€ä½³ä½ç½®ï¼', mapLink: 'https://www.google.com/maps/place/Sham+Shui+Po' },
            { time: '13:30 - 17:00', icon: 'â›°ï¸', title: 'å¤ªå¹³å±±çš„æ—¥é–“å…¨æ™¯', duration: 'ç´„3.5å°æ™‚', transport: 'å¾ä¸­ç’°äº¤æ˜“å»£å ´å·´å£«ç¸½ç«™ï¼Œæ­ä¹˜åŸå·´15è™Ÿä¸Šå±± (ç´„HKD 12.80)', price: 'å…è²» (è§€æ™¯å°)', details: 'æ­ä¹˜ç¶“å…¸çš„é›™å±¤å·´å£«ä¸Šå±±ã€‚æŠµé”å¾Œï¼Œæ²¿ç›§å‰é“èµ°ä¸€å°æ®µï¼Œé‚£è£¡çš„å…è²»è§€æ™¯å°èƒ½æ‹åˆ°æœ€ç¶“å…¸çš„ç¶­æ¸¯ç™½å¤©æ™¯è‰²ã€‚è‹¥æ„Ÿç–²ç´¯ï¼Œå¯åœ¨å¤§é¤¨ç¨ä½œä¼‘æ¯å¾Œå†ä¸Šå±±ã€‚', mapLink: 'https://www.google.com/maps/place/Victoria+Peak'},
            { time: '17:30 - 20:00', icon: 'ğŸŒ‡', title: 'ç´…é¦™çˆå³°çš„æ—¥è½ä»»å‹™', duration: 'ç´„2.5å°æ™‚', transport: 'å¾ä¸­ç’°æ­ä¹˜å·´å£« 10 è™Ÿ (ç´„HKD 6.50) åˆ°ã€Œé›²æ™¯é“ã€ç«™ï¼Œé–‹å§‹ç™»å±±', price: 'å…è²»', details: 'å®Œæˆç™½å¤©çš„å±±é ‚ä¹‹æ—…å¾Œï¼ŒæŒ‘æˆ°æ›´å°çœ¾çš„å¤œæ™¯ç§˜å¢ƒï¼å¾å¤©åç™»å±±ç´„30-40åˆ†é˜ï¼Œåœ¨å±±é ‚è¿æ¥æœ€ç¾çš„æ—¥è½å’Œè¯ç‡ˆåˆä¸Šã€‚è¨˜å¾—å¸¶æ°´å’Œç”¨æ‰‹æ©Ÿç•¶é›»ç­’ã€‚', mapLink: 'https://www.google.com/maps/place/Red+Incense+Burner+Summit' }
        ],
        "Day 8 (Wed, Jun 25)": [
            { time: '09:00 - 12:00', icon: 'ğŸŒ³', title: 'å¯§éœçš„å‘Šåˆ¥èˆ‡æ­¸é€”', duration: 'ç´„3å°æ™‚', transport: 'å¾è§€å¡˜æ­ä¹˜å·´å£« 2F è™Ÿ (ç´„HKD 5.40) åˆ°ã€Œé‘½çŸ³å±±ç«™ã€', details: 'å¸¶è‘—èƒŒåŒ…å‡ºé–€ã€‚åœ¨å¿—è“®æ·¨è‹‘å’Œå—è“®åœ’æ± åº¦éæ—…ç¨‹çš„æœ€å¾Œä¸€å€‹ä¸Šåˆã€‚é€™è£¡çš„å¯§éœå’Œå”ä»£åœ’æ—å»ºç¯‰ï¼Œæœƒæ˜¯ä½ é¦™æ¸¯è¨˜æ†¶ä¸­ä¸€å€‹éå¸¸ç¾å¥½çš„å¥é»ã€‚', price: 'å…è²»', mapLink: 'https://www.google.com/maps/place/Chi+Lin+Nunnery' },
            { time: '12:15', icon: 'âœˆï¸', title: 'å‰å¾€æ©Ÿå ´', duration: 'ç´„70-80åˆ†é˜', transport: 'å¾é‘½çŸ³å±±ç«™æ—çš„å·´å£«ç¸½ç«™ï¼Œæ­ä¹˜åŸå·´E22ç›´é”æ©Ÿå ´', price: 'HKD 18.00', details: 'é€™æ¢è·¯ç·šéå¸¸æ–¹ä¾¿ï¼Œè®“ä½ ä¸ç”¨å†æ‹–è‘—è¡Œæè½‰è»Šã€‚é è¨ˆ1:30å·¦å³å°±èƒ½æŠµé”æ©Ÿå ´ï¼Œæ™‚é–“éå¸¸å……è£•ã€‚', mapLink: 'https://www.google.com/maps/search/?api=1&query=Diamond+Hill+Station+Public+Transport+Interchange' },
        ]
    };

    const foodData = [
        { name: 'æ·»å¥½é‹é»å¿ƒå°ˆé–€åº—', category: 'é»å¿ƒ', desc: 'å…¨çƒæœ€å¹³åƒ¹çš„ç±³å…¶æ—ä¸€æ˜Ÿé¤å»³', mapLink: 'https://www.google.com/maps/search/?api=1&query=Tim+Ho+Wan+Sham+Shui+Po' },
        { name: 'ä¹è¨˜ç‰›è…©', category: 'ç²‰éºµ', desc: 'ä»¥æ¸…æ¹¯ç‰›è…©èåçš„å‚³å¥‡éºµåº—', mapLink: 'https://www.google.com/maps/search/?api=1&query=Kau+Kee+Restaurant+Central' },
        { name: 'è˜­èŠ³åœ’', category: 'èŒ¶é¤å»³', desc: 'çµ²è¥ªå¥¶èŒ¶èˆ‡è±¬æ‰’åŒ…çš„å‰µå§‹åº—', mapLink: 'https://www.google.com/maps/search/?api=1&query=Lan+Fong+Yuen+Central' },
        { name: 'æ¾³æ´²ç‰›å¥¶å…¬å¸', category: 'èŒ¶é¤å»³', desc: 'ä»¥ç‚’è›‹å¤šå£«å’Œæ¥µé€Ÿæœå‹™èå', mapLink: 'https://www.google.com/maps/search/?api=1&query=Australia+Dairy+Company' },
        { name: 'æ¨‚åœ’', category: 'èŒ¶é¤å»³', desc: 'ä½æ–¼ç†Ÿé£Ÿä¸­å¿ƒï¼Œæ‹›ç‰Œæ²™å—²ç‰›è¥¿å¤šå£«', mapLink: 'https://www.google.com/maps/search/?api=1&query=Lok+Yuen+Kowloon+City' },
        { name: 'æ¸…çœŸç‰›è‚‰é¤¨', category: 'ç‰¹è‰²å°é£Ÿ', desc: 'å¿…è©¦æ¹¯æ±æ»¿æº¢çš„ç‰›è‚‰é¤…', mapLink: 'https://www.google.com/maps/search/?api=1&query=Islam+Food+Kowloon+City' },
        { name: 'Bakehouse', category: 'ç‰¹è‰²å°é£Ÿ', desc: 'æ–°æ´¾çƒ˜ç„™åº—ï¼Œä»¥é…¸ç¨®è›‹æ’»èå', mapLink: 'https://www.google.com/maps/search/?api=1&query=Bakehouse+Central' },
    ];

    // --- Gemini API ---
    const API_KEY = ""; // Leave blank
    const API_URL_TEXT = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
    
    async function callGemini(prompt, schema = null) {
        const payload = {
            contents: [{ role: "user", parts: [{ text: prompt }] }],
        };

        if (schema) {
            payload.generationConfig = {
                responseMimeType: "application/json",
                responseSchema: schema
            };
        }

        try {
            const response = await fetch(API_URL_TEXT, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            if (!response.ok) {
                throw new Error(`API call failed with status: ${response.status}`);
            }
            const result = await response.json();
             if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                return result.candidates[0].content.parts[0].text;
            } else {
                throw new Error("Invalid response structure from API");
            }
        } catch (error) {
            console.error("Gemini API Error:", error);
            return null;
        }
    }


    // --- Modal ---
    const modal = document.getElementById('gemini-modal');
    const modalTitle = document.getElementById('gemini-modal-title');
    const modalContent = document.getElementById('gemini-modal-content');
    const modalCloseBtn = document.getElementById('gemini-modal-close');

    function showModal(title, content) {
        modalTitle.textContent = title;
        modalContent.innerHTML = content;
        modal.classList.remove('hidden');
        setTimeout(() => modal.classList.remove('opacity-0'), 10);
    }

    function hideModal() {
        modal.classList.add('opacity-0');
        setTimeout(() => modal.classList.add('hidden'), 300);
    }

    modalCloseBtn.addEventListener('click', hideModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            hideModal();
        }
    });

    // --- RENDER FUNCTIONS ---
    function renderItinerary() {
        const itineraryContainer = document.getElementById('itinerary-content');
        const dayTabsContainer = document.getElementById('day-tabs-container');
        itineraryContainer.innerHTML = '';
        dayTabsContainer.innerHTML = '';

        Object.keys(itineraryData).forEach((day, index) => {
            const dayTab = document.createElement('button');
            dayTab.textContent = day;
            dayTab.className = `day-tab-btn px-4 py-2 rounded-full text-sm font-semibold transition-colors duration-300 ${index === 0 ? 'active' : ''}`;
            dayTab.dataset.day = day;
            dayTabsContainer.appendChild(dayTab);

            const dayId = day.replace(/[\s(),]/g, '-');
            const dayContent = document.createElement('div');
            dayContent.id = dayId;
            dayContent.className = `day-content ${index !== 0 ? 'hidden' : ''}`;
            
            let timelineHTML = '';
            
            // Add Gemini alternative plan button, but not for Friend Day
            if (day.toLowerCase().indexOf('friend') === -1 && day.toLowerCase().indexOf('day-1') === -1) {
                timelineHTML += `
                    <div class="text-center mb-6">
                        <button class="gemini-alt-plan-btn gemini-btn" data-day-plan-key="${day}">âœ¨ å»ºè­°ä¸€å€‹æ›¿ä»£æ–¹æ¡ˆ</button>
                    </div>
                `;
            }

            timelineHTML += '<div class="relative pl-8">';
            itineraryData[day].forEach((item, itemIndex) => {
                const priceInfo = item.price ? `<p><strong>é–€ç¥¨/é ç®—:</strong> <span class="text-green-700 font-semibold">${item.price}</span></p>` : '';
                const tellMeMoreBtn = ['ä¸­ç’°å¤è¹Ÿèˆ‡è—è¡“å€æ¢ç´¢', 'ä¸Šç’°æ–‡åŒ–æ•£ç­–', 'æ·±æ°´åŸ—çš„æ­·å²èˆ‡å¸‚äº•', 'æ—ºè§’æ½®æµæ–‡åŒ–æ¢ç´¢', 'é¦™æ¸¯æ–‡åŒ–åšç‰©é¤¨', 'é‘½çŸ³å±±å°‹å¹½', 'å¤ªå¹³å±±çš„æ—¥é–“å…¨æ™¯', 'ç´…é¦™çˆå³°çš„æ—¥è½ä»»å‹™'].includes(item.title)
                    ? `<button class="gemini-info-btn" data-topic="${item.title}">âœ¨ å‘Šè¨´æˆ‘æ›´å¤š</button>` : '';

                timelineHTML += `
                    <div class="timeline-item relative mb-8">
                        ${itemIndex < itineraryData[day].length - 1 ? '<div class="timeline-connector"></div>' : ''}
                        <div class="p-4 bg-[color:var(--card-bg)] rounded-lg shadow-sm border border-[color:var(--border-color)]">
                             <div class="flex justify-between items-center">
                                <p class="font-bold text-lg text-[color:var(--primary-accent)]">${item.icon} ${item.title}</p>
                                ${tellMeMoreBtn}
                            </div>
                            <div class="text-sm text-gray-600 mt-2 space-y-1">
                                <p><strong>æ™‚é–“:</strong> ${item.time}</p>
                                <p><strong>åœç•™:</strong> ${item.duration}</p>
                                <p><strong>äº¤é€š:</strong> ${item.transport}</p>
                                ${priceInfo}
                                <p>${item.details}</p>
                                <a href="${item.mapLink}" target="_blank" class="text-[color:var(--secondary-accent)] hover:underline font-semibold inline-block mt-1">åœ¨ Google åœ°åœ–ä¸ŠæŸ¥çœ‹ â†—</a>
                            </div>
                        </div>
                    </div>
                `;
            });
            timelineHTML += '</div>';
            dayContent.innerHTML = timelineHTML;
            itineraryContainer.appendChild(dayContent);
        });

        const style = document.createElement('style');
        style.innerHTML = `.day-tab-btn { background-color: #e2e8f0; color: #4a5568; } .day-tab-btn.active { background-color: var(--primary-accent); color: white; }`;
        document.head.appendChild(style);
    }
    
    function renderFoodMap(category = 'all') {
        const foodList = document.getElementById('food-list');
        foodList.innerHTML = '';
        const filteredData = category === 'all' ? foodData : foodData.filter(item => item.category === category);
        filteredData.forEach(item => {
            const card = document.createElement('div');
            card.className = 'food-card bg-[color:var(--card-bg)] p-4 rounded-lg shadow-sm border border-[color:var(--border-color)] transition-transform duration-300 hover:scale-105';
            card.dataset.category = item.category;
            card.innerHTML = `<a href="${item.mapLink}" target="_blank" class="text-xl font-bold text-[color:var(--primary-accent)] hover:text-[color:var(--secondary-accent)]">${item.name}</a><p class="text-gray-500 text-sm my-2">${item.desc}</p><span class="inline-block bg-blue-100 text-[color:var(--primary-accent)] text-xs font-semibold px-2 py-1 rounded-full">${item.category}</span>`;
            foodList.appendChild(card);
        });
    }

    // --- EVENT LISTENERS ---
    const mainNav = document.getElementById('main-nav');
    const contentSections = document.querySelectorAll('.content-section');
    mainNav.addEventListener('click', (e) => {
        if (e.target.tagName === 'BUTTON') {
            const targetId = e.target.dataset.target;
            mainNav.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            contentSections.forEach(section => section.id === targetId ? section.classList.remove('hidden') : section.classList.add('hidden'));
        }
    });

    const itinerarySection = document.getElementById('daily-itinerary');
    itinerarySection.addEventListener('click', (e) => {
        if (e.target.classList.contains('day-tab-btn')) {
            const targetDay = e.target.dataset.day;
            itinerarySection.querySelectorAll('.day-tab-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            itinerarySection.querySelectorAll('.day-content').forEach(content => content.id === targetDay.replace(/[\s(),]/g, '-') ? content.classList.remove('hidden') : content.classList.add('hidden'));
        }
        if (e.target.classList.contains('gemini-info-btn')) {
            handleTellMeMore(e.target.dataset.topic);
        }
        if (e.target.classList.contains('gemini-alt-plan-btn')) {
            handleAlternativePlan(e.target.dataset.dayPlanKey);
        }
    });

    const foodFilters = document.getElementById('food-filters');
    foodFilters.addEventListener('click', (e) => {
        if (e.target.classList.contains('food-filter-btn')) {
            const category = e.target.dataset.category;
            foodFilters.querySelectorAll('.food-filter-btn').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            renderFoodMap(category);
        }
    });
    
    // --- Gemini Handlers ---
    async function handleTellMeMore(topic) {
        showModal('âœ¨ æ­£åœ¨ç‚ºæ‚¨æŸ¥è©¢...', '<p class="text-center">è«‹ç¨å€™...</p>');
        const prompt = `As a friendly tour guide, tell me a brief, interesting fact about "${topic}" in Hong Kong for a solo female traveler. Keep it under 60 words and write in Traditional Chinese.`;
        const response = await callGemini(prompt);
        if (response) {
            showModal(`âœ¨ é—œæ–¼ ${topic}`, `<p>${response.replace(/\n/g, '<br>')}</p>`);
        } else {
            showModal('ğŸ˜• ç™¼ç”ŸéŒ¯èª¤', '<p>æŠ±æ­‰ï¼Œç„¡æ³•å–å¾—è³‡è¨Šã€‚è«‹ç¨å¾Œå†è©¦ã€‚</p>');
        }
    }

    async function handleAlternativePlan(dayKey) {
        showModal('âœ¨ æ­£åœ¨è¦åŠƒæ‚¨çš„å°ˆå±¬è¡Œç¨‹...', '<p class="text-center">è«‹ç¨å€™ï¼ŒAI åŠ©ç†æ­£åœ¨ç‚ºæ‚¨å®¢è£½åŒ–æ–°è¨ˆç•«...</p>');
        const originalPlan = itineraryData[dayKey].map(item => item.title).join(', ');
        
        const prompt = `I am a solo female traveler in Hong Kong. My original plan for today was: ${originalPlan}. Please suggest a completely different, full-day alternative itinerary for me. My interests are walking, natural scenery, architecture, movies, bookstores, exhibitions, and museums. The plan should be safe, budget-friendly (mostly free attractions), suitable for rainy weather, and located in a single, easily accessible district (like Kowloon West, or Hong Kong Island's Eastern District). Please respond in Traditional Chinese.`;

        const schema = {
            type: "ARRAY",
            items: {
                type: "OBJECT",
                properties: {
                    time: { type: "STRING" },
                    icon: { type: "STRING" },
                    title: { type: "STRING" },
                    details: { type: "STRING" }
                },
                required: ["time", "icon", "title", "details"]
            }
        };

        const response = await callGemini(prompt, schema);
        if (response) {
            try {
                const newPlan = JSON.parse(response);
                let htmlContent = '<div class="space-y-4">';
                newPlan.forEach(item => {
                    htmlContent += `
                        <div class="p-3 bg-gray-100 rounded-lg">
                            <p class="font-bold">${item.icon || 'ğŸ“'} ${item.time}: ${item.title}</p>
                            <p class="text-sm text-gray-600 pl-6">${item.details}</p>
                        </div>
                    `;
                });
                htmlContent += '</div>';
                showModal('âœ¨ æ‚¨çš„å°ˆå±¬æ›¿ä»£æ–¹æ¡ˆ', htmlContent);
            } catch (e) {
                console.error("Error parsing Gemini JSON:", e);
                showModal('ğŸ˜• ç™¼ç”ŸéŒ¯èª¤', '<p>æŠ±æ­‰ï¼Œç„¡æ³•ç”Ÿæˆæ–°è¨ˆç•«ã€‚APIå›å‚³æ ¼å¼æœ‰èª¤ã€‚</p>');
            }
        } else {
            showModal('ğŸ˜• ç™¼ç”ŸéŒ¯èª¤', '<p>æŠ±æ­‰ï¼Œç„¡æ³•ç”Ÿæˆæ–°è¨ˆç•«ã€‚è«‹ç¨å¾Œå†è©¦ã€‚</p>');
        }
    }

    // --- INITIALIZATION ---
    function initializeApp() {
        mainNav.querySelector('button[data-target="overview"]').classList.add('active');
        document.getElementById('overview').classList.remove('hidden');
        renderItinerary();
        renderFoodMap();

        const foodFilterStyle = document.createElement('style');
        foodFilterStyle.innerHTML = `.food-filter-btn { background-color: #e2e8f0; color: #4a5568; padding: 0.5rem 1rem; border-radius: 9999px; font-weight: 500; transition: all 0.2s; } .food-filter-btn.active { background-color: var(--secondary-accent); color: white; }`;
        document.head.appendChild(foodFilterStyle);

        const ctx = document.getElementById('transportationChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['æ©Ÿå ´å¿«ç·š', 'å·´å£«A22(ç›´é”)', 'çš„å£«'],
                datasets: [
                    { label: 'é ä¼°æ™‚é–“ (åˆ†é˜)', data: [55, 70, 45], backgroundColor: 'rgba(107, 122, 143, 0.7)' },
                    { label: 'é ä¼°è²»ç”¨ (HKD)', data: [110, 40.80, 300], backgroundColor: 'rgba(213, 160, 140, 0.7)' }
                ]
            },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true } } }
        });
    }

    initializeApp();
});
</script>
</body>
</html>
