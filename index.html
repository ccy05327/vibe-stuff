<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vibe Stuff Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #f8fafc 0%, #e0e7ef 100%);
      }
      .section-content {
        transition: all 0.3s ease-in-out;
        overflow: hidden;
      }
      .section-content.collapsed {
        max-height: 0;
        opacity: 0;
        margin-top: 0;
        margin-bottom: 0;
      }
      .section-toggle {
        transition: transform 0.3s ease-in-out;
      }
      .section-toggle.collapsed {
        transform: rotate(-90deg);
      }
      .section-header {
        cursor: pointer;
        user-select: none;
      }
      .section-header:hover {
        opacity: 0.8;
      }
      .search-item {
        transition: opacity 0.2s ease-in-out;
      }
      .search-item.hidden {
        display: none;
      }
      .search-highlight {
        background-color: #fef3c7;
        padding: 1px 2px;
        border-radius: 2px;
      }
    </style>
  </head>
  <body
    class="min-h-screen flex flex-col items-center justify-center text-gray-800 bg-gradient-to-br from-slate-50 to-blue-50"
  >
    <header class="mb-6 mt-6 md:mb-10 md:mt-12 text-center px-3">
      <h1
        class="text-2xl md:text-3xl lg:text-5xl font-extrabold text-blue-700 mb-1 md:mb-2 leading-tight"
      >
        Vibe Stuff Portal
      </h1>
      <p class="text-sm md:text-base lg:text-lg text-gray-500">
        歡迎來到我的Vibe Coding小天地
      </p>
    </header>

    <!-- Search Section -->
    <div class="w-full max-w-2xl mx-auto px-3 md:px-4 mb-6">
      <div class="relative">
        <input
          type="text"
          id="searchInput"
          placeholder="Search your content... (supports English & 中文)"
          class="w-full p-3 md:p-4 rounded-xl border border-gray-200 focus:border-blue-400 focus:ring-2 focus:ring-blue-100 outline-none transition-all duration-200 text-sm md:text-base"
          oninput="filterItems()"
        />
        <div
          class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"
        >
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            ></path>
          </svg>
        </div>
      </div>
      <div id="searchResults" class="mt-2 text-sm text-gray-500 hidden">
        <span id="resultsCount"></span>
      </div>
      <div id="noResults" class="mt-4 text-center text-gray-500 hidden">
        <p class="text-sm">No items found matching your search.</p>
        <button
          onclick="clearSearch()"
          class="mt-2 text-blue-600 hover:text-blue-800 text-sm underline"
        >
          Clear search
        </button>
      </div>
    </div>

    <main class="w-full max-w-2xl mx-auto px-3 md:px-4">
      <div class="space-y-4 md:space-y-6 lg:space-y-10">
        <!-- Life Section -->
        <section>
          <h2
            class="section-header text-lg md:text-xl lg:text-2xl font-bold text-blue-700 mb-2 md:mb-4 flex items-center justify-between"
            onclick="toggleSection('life')"
          >
            <div class="flex items-center">
              <span class="mr-2 text-base md:text-lg lg:text-xl">🌱</span>Life
            </div>
            <span class="section-toggle text-lg">▼</span>
          </h2>
          <div
            id="life-content"
            class="section-content space-y-2 md:space-y-3 lg:space-y-4"
          >
            <a
              href="life/mbti.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-blue-100 hover:border-blue-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🧬</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-blue-700 leading-tight pr-4"
                    >
                      My MBTI Journey
                    </h3>
                    <span
                      class="text-xs text-blue-400 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/28
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    歷年來的MBTI紀錄跟變化
                  </p>
                </div>
              </div>
            </a>
            <a
              href="life/questboard.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-blue-100 hover:border-blue-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🗂️</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-blue-700 leading-tight pr-4"
                    >
                      Questboard Portal
                    </h3>
                    <span
                      class="text-xs text-blue-400 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/25
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    Personal planner, checklist, and event tracker with
                    countdowns and calendar.
                  </p>
                </div>
              </div>
            </a>
          </div>
        </section>
        <!-- Travel Section -->
        <section>
          <h2
            class="section-header text-lg md:text-xl lg:text-2xl font-bold text-green-700 mb-2 md:mb-4 flex items-center justify-between"
            onclick="toggleSection('travel')"
          >
            <div class="flex items-center">
              <span class="mr-2 text-base md:text-lg lg:text-xl">🌏</span>Travel
            </div>
            <span class="section-toggle text-lg">▼</span>
          </h2>
          <div
            id="travel-content"
            class="section-content space-y-2 md:space-y-3 lg:space-y-4"
          >
            <a
              href="travel/淡蘭古道.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-green-100 hover:border-green-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🥾</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-green-700 leading-tight pr-4"
                    >
                      淡蘭北路
                    </h3>
                    <span
                      class="text-xs text-blue-400 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/07/04
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    詳細規劃三天兩夜的淡蘭古道北路行程
                  </p>
                </div>
              </div>
            </a>
            <a
              href="travel/ST9.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-green-100 hover:border-green-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🗺️</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-green-700 leading-tight pr-4"
                    >
                      Upcoming Secret Trip
                    </h3>
                    <span
                      class="text-xs text-blue-400 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/27
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    👀 upcoming ST9 trip
                  </p>
                </div>
              </div>
            </a>
            <a
              href="travel/ST8.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-green-100 hover:border-green-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🧳</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-green-700 leading-tight pr-4"
                    >
                      ST8 Trip
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/25
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    從計畫、預算、事後回顧，都詳細記錄了
                  </p>
                </div>
              </div>
            </a>
          </div>
        </section>
        <!-- Learning Section -->
        <section>
          <h2
            class="section-header text-lg md:text-xl lg:text-2xl font-bold text-yellow-600 mb-2 md:mb-4 flex items-center justify-between"
            onclick="toggleSection('learning')"
          >
            <div class="flex items-center">
              <span class="mr-2 text-base md:text-lg lg:text-xl">💡</span
              >Learning
            </div>
            <span class="section-toggle text-lg">▼</span>
          </h2>
          <div
            id="learning-content"
            class="section-content space-y-2 md:space-y-3 lg:space-y-4"
          >
            <a
              href="learning/iPAS_certification/"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-yellow-100 hover:border-yellow-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🏆</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-yellow-600 leading-tight pr-4"
                    >
                      iPAS AI 應用規劃師認證攻略
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/07/08
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中文 | 專為倫敦大學電腦科學畢業生打造的iPAS
                    AI應用規劃師認證互動策略藍圖
                  </p>
                </div>
              </div>
            </a>
            <a
              href="learning/urban_stickiness/"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-yellow-100 hover:border-yellow-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🏙️</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-yellow-600 leading-tight pr-4"
                    >
                      The Magnetic City "黏"性最高的城市
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/07/05
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中&英 | IG上 @seasia.news @seasia.stats
                    發文啟發的研究，英文版比較全面
                  </p>
                </div>
              </div>
            </a>
            <a
              href="learning/humidity_comparison/"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-yellow-100 hover:border-yellow-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >💧</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-yellow-600 leading-tight pr-4"
                    >
                      全球濕度比較
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/28
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中文 |
                    互動式儀表板，探索世界主要城市與台灣濕度的比較與氣候知識
                  </p>
                </div>
              </div>
            </a>
            <a
              href="learning/snap_judgement/"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-yellow-100 hover:border-yellow-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >⚡</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-yellow-600 leading-tight pr-4"
                    >
                      Snap Judgement 速判
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/28
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中&英 | 在IG上看到@a_day_mag的發文在講Snap
                    Judgement，想知道背後故事跟學習媒體識讀，就跑去做研究產生了這個網站
                  </p>
                </div>
              </div>
            </a>

            <a
              href="learning/HK-TW_healthcheck/index.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-yellow-100 hover:border-yellow-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🏥</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-yellow-600 leading-tight pr-4"
                    >
                      香港台灣健檢大比較
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/16
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中文 |
                    本只是跟朋友聊到她要去做健檢，我問了價格發現比台灣便宜覺得困惑，按照香港物價/薪資所得，應該要比較貴才對，然後就產生這篇研究
                  </p>
                </div>
              </div>
            </a>
          </div>
        </section>
        <!-- Miscellaneous Section -->
        <section>
          <h2
            class="section-header text-lg md:text-xl lg:text-2xl font-bold text-purple-700 mb-2 md:mb-4 flex items-center justify-between"
            onclick="toggleSection('miscellaneous')"
          >
            <div class="flex items-center">
              <span class="mr-2 text-base md:text-lg lg:text-xl">🔧</span
              >Miscellaneous
            </div>
            <span class="section-toggle text-lg">▼</span>
          </h2>
          <div
            id="miscellaneous-content"
            class="section-content space-y-2 md:space-y-3 lg:space-y-4"
          >
            <a
              href="miscellaneous/US_BTS.html"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-purple-100 hover:border-purple-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🍎</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-purple-700 leading-tight pr-4"
                    >
                      北美Apple購物成本分析儀表板
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/07/08
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    中文 | 互動式儀表板分析北美西岸四大城市的Back to
                    School購物成本，包含機票、住宿、稅務及產品總成本比較
                  </p>
                </div>
              </div>
            </a>
            <a
              href="miscellaneous/46XX_PAR1_Deletion/"
              class="search-item block bg-white rounded-xl shadow-md hover:shadow-lg transition p-3 md:p-4 lg:p-5 border border-purple-100 hover:border-purple-300 relative min-h-[64px] md:min-h-[56px]"
            >
              <div class="flex items-start">
                <span
                  class="text-lg md:text-xl lg:text-2xl mr-2 md:mr-3 lg:mr-4 mt-0.5"
                  >🧬</span
                >
                <div class="min-w-0 flex-1">
                  <div class="flex items-start justify-between mb-2">
                    <h3
                      class="text-sm md:text-base lg:text-lg font-bold text-purple-700 leading-tight pr-4"
                    >
                      46,XX DSD & PAR1 Deletion
                    </h3>
                    <span
                      class="text-xs text-gray-500 bg-white bg-opacity-80 rounded px-1.5 py-0.5 shadow-sm whitespace-nowrap"
                    >
                      2025/06/19
                    </span>
                  </div>
                  <p class="text-gray-500 text-xs md:text-sm leading-tight">
                    英文 | 幫朋友測試gemini deep
                    research功能，協助同事工作上的事
                  </p>
                </div>
              </div>
            </a>
          </div>
        </section>
      </div>
      <footer
        class="mt-8 md:mt-12 text-center text-xs text-gray-400 px-3 leading-relaxed"
      >
        &copy; 2025 Vibe Stuff, prompted by Cynthia using Gemini Deep Research +
        Cursor
      </footer>
    </main>

    <script>
      function toggleSection(sectionName) {
        const content = document.getElementById(sectionName + "-content");
        const toggle = document.querySelector(
          `[onclick="toggleSection('${sectionName}')"] .section-toggle`
        );

        if (content.classList.contains("collapsed")) {
          // Expand
          content.classList.remove("collapsed");
          content.style.maxHeight = content.scrollHeight + "px";
          toggle.classList.remove("collapsed");
        } else {
          // Collapse
          content.style.maxHeight = content.scrollHeight + "px";
          // Force reflow
          content.offsetHeight;
          content.style.maxHeight = "0";
          content.classList.add("collapsed");
          toggle.classList.add("collapsed");
        }
      }

      function filterItems() {
        const searchTerm = document
          .getElementById("searchInput")
          .value.toLowerCase()
          .trim();
        const searchItems = document.querySelectorAll(".search-item");
        const sections = ["life", "travel", "learning", "miscellaneous"];
        const searchResults = document.getElementById("searchResults");
        const resultsCount = document.getElementById("resultsCount");
        const noResults = document.getElementById("noResults");

        let visibleCount = 0;
        let hasVisibleItemsInSection = {};

        // Initialize section visibility tracking
        sections.forEach((section) => {
          hasVisibleItemsInSection[section] = false;
        });

        // Get all search terms including translations
        const allSearchTerms = getSearchTerms(searchTerm);

        searchItems.forEach((item) => {
          const title = item.querySelector("h3").textContent.toLowerCase();
          const description = item.querySelector("p").textContent.toLowerCase();

          // Check if any of the search terms (including translations) match
          let isMatch = false;
          let matchedTerm = "";

          if (searchTerm !== "") {
            for (const term of allSearchTerms) {
              const termLower = term.toLowerCase();
              if (
                title.includes(termLower) ||
                description.includes(termLower)
              ) {
                isMatch = true;
                matchedTerm = term;
                break;
              }
            }
          }

          if (searchTerm === "" || isMatch) {
            item.classList.remove("hidden");
            visibleCount++;

            // Track which section this item belongs to
            const parentSection = item.closest('[id$="-content"]');
            if (parentSection) {
              const sectionName = parentSection.id.replace("-content", "");
              hasVisibleItemsInSection[sectionName] = true;
            }

            // Remove any existing highlights and add new ones
            removeHighlights(item);
            if (searchTerm !== "" && isMatch) {
              // Highlight the original search term for consistency
              highlightText(item, searchTerm);
              // Also highlight the matched translation term if different
              if (
                matchedTerm !== searchTerm &&
                matchedTerm.toLowerCase() !== searchTerm.toLowerCase()
              ) {
                highlightText(item, matchedTerm);
              }
            }
          } else {
            item.classList.add("hidden");
            removeHighlights(item);
          }
        });

        // Show/hide sections based on whether they have visible items
        sections.forEach((sectionName) => {
          const sectionContent = document.getElementById(
            sectionName + "-content"
          );
          const sectionHeader = document.querySelector(
            `[onclick="toggleSection('${sectionName}')"]`
          );
          const toggle = sectionHeader.querySelector(".section-toggle");

          if (searchTerm === "" || hasVisibleItemsInSection[sectionName]) {
            sectionHeader.style.display = "flex";
            if (searchTerm !== "") {
              // Auto-expand sections with results
              sectionContent.classList.remove("collapsed");
              sectionContent.style.maxHeight =
                sectionContent.scrollHeight + "px";
              toggle.classList.remove("collapsed");
            } else {
              // When search is cleared, recalculate height for expanded sections
              if (!sectionContent.classList.contains("collapsed")) {
                sectionContent.style.maxHeight =
                  sectionContent.scrollHeight + "px";
              }
            }
          } else {
            sectionHeader.style.display = "none";
          }
        });

        // Update search results display
        if (searchTerm === "") {
          searchResults.classList.add("hidden");
          noResults.classList.add("hidden");

          // Ensure all sections are visible and properly sized when search is cleared
          sections.forEach((sectionName) => {
            const sectionHeader = document.querySelector(
              `[onclick="toggleSection('${sectionName}')"]`
            );
            const sectionContent = document.getElementById(
              sectionName + "-content"
            );
            sectionHeader.style.display = "flex";

            // Recalculate height for expanded sections
            if (!sectionContent.classList.contains("collapsed")) {
              setTimeout(() => {
                sectionContent.style.maxHeight =
                  sectionContent.scrollHeight + "px";
              }, 10);
            }
          });
        } else {
          if (visibleCount > 0) {
            const usingTranslations = allSearchTerms.length > 1;
            resultsCount.textContent = `Found ${visibleCount} item${
              visibleCount === 1 ? "" : "s"
            }${usingTranslations ? " (bilingual search)" : ""}`;
            searchResults.classList.remove("hidden");
            noResults.classList.add("hidden");
          } else {
            searchResults.classList.add("hidden");
            noResults.classList.remove("hidden");
          }
        }
      }

      function clearSearch() {
        document.getElementById("searchInput").value = "";
        filterItems();

        // Force recalculation of section heights after clearing search
        setTimeout(() => {
          const sections = ["life", "travel", "learning", "miscellaneous"];
          sections.forEach((sectionName) => {
            const content = document.getElementById(sectionName + "-content");
            if (!content.classList.contains("collapsed")) {
              content.style.maxHeight = content.scrollHeight + "px";
            }
          });
        }, 50);
      }

      function highlightText(item, searchTerm) {
        const title = item.querySelector("h3");
        const description = item.querySelector("p");

        [title, description].forEach((element) => {
          // Store original text only once
          if (!element.getAttribute("data-original-text")) {
            element.setAttribute("data-original-text", element.textContent);
          }

          // Get current content (which might already have highlights)
          const currentContent = element.innerHTML;
          const regex = new RegExp(`(${escapeRegex(searchTerm)})`, "gi");

          // Only add highlights if this term isn't already highlighted
          if (
            !currentContent.includes(`>${searchTerm}<`) &&
            !currentContent.includes(`>${searchTerm.toLowerCase()}<`) &&
            !currentContent.includes(`>${searchTerm.toUpperCase()}<`)
          ) {
            const highlightedText = currentContent.replace(
              regex,
              '<span class="search-highlight">$1</span>'
            );
            element.innerHTML = highlightedText;
          }
        });
      }

      function removeHighlights(item) {
        const title = item.querySelector("h3");
        const description = item.querySelector("p");

        [title, description].forEach((element) => {
          const originalText = element.getAttribute("data-original-text");
          if (originalText) {
            element.textContent = originalText;
          }
        });
      }

      function escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      }

      // Bilingual translation dictionary for search enhancement
      const translationMap = {
        // Travel related
        travel: ["旅行", "旅遊", "出遊"],
        trip: ["旅行", "行程", "旅遊"],
        journey: ["旅程", "行程"],
        planning: ["規劃", "計畫"],
        itinerary: ["行程"],

        // Learning/Research related
        research: ["研究", "調查"],
        study: ["學習", "研究"],
        learning: ["學習", "學會"],
        analysis: ["分析", "研究"],
        comparison: ["比較", "對比"],
        interactive: ["互動", "互動式"],
        dashboard: ["儀表板", "控制台"],

        // Health related
        health: ["健康", "健檢"],
        medical: ["醫療", "醫學"],
        checkup: ["健檢", "檢查"],

        // Technology related
        certification: ["認證", "證照"],
        application: ["應用", "申請"],
        planner: ["規劃師", "規劃"],
        portal: ["入口", "門戶"],

        // Life related
        life: ["生活", "人生"],
        personal: ["個人", "私人"],
        questboard: ["任務板", "清單"],
        tracker: ["追蹤", "記錄"],
        calendar: ["日曆", "行事曆"],

        // General terms
        cost: ["成本", "費用", "價格"],
        price: ["價格", "費用"],
        shopping: ["購物", "買東西"],
        city: ["城市", "都市"],
        urban: ["城市", "都市"],
        magnetic: ["磁性", "吸引", "黏性"],
        humidity: ["濕度", "潮濕"],
        global: ["全球", "世界"],
        world: ["世界", "全球"],
        snap: ["快速", "速判"],
        judgement: ["判斷", "速判"],
        judgment: ["判斷", "速判"],
        secret: ["秘密", "神秘"],
        upcoming: ["即將", "未來"],

        // Specific content terms
        mbti: ["MBTI", "人格", "性格"],
        personality: ["人格", "性格", "MBTI"],
        apple: ["蘋果", "Apple"],
        hongkong: ["香港", "HK"],
        taiwan: ["台灣", "TW", "臺灣"],
        ipas: ["iPAS", "認證"],
        trail: ["古道", "步道"],
        hiking: ["健行", "登山", "徒步"],
        genetics: ["基因", "遺傳", "染色體"],
        chromosome: ["染色體", "基因"],
        dsd: ["DSD", "性發育"],

        // Chinese to English
        旅行: ["travel", "trip", "journey"],
        旅遊: ["travel", "tourism", "trip"],
        行程: ["itinerary", "schedule", "trip"],
        規劃: ["planning", "plan"],
        計畫: ["plan", "planning"],
        研究: ["research", "study", "analysis"],
        學習: ["learning", "study"],
        分析: ["analysis", "analyze"],
        比較: ["comparison", "compare"],
        互動: ["interactive"],
        儀表板: ["dashboard"],
        健康: ["health"],
        健檢: ["health checkup", "medical checkup"],
        認證: ["certification"],
        應用: ["application"],
        規劃師: ["planner"],
        生活: ["life"],
        個人: ["personal"],
        成本: ["cost"],
        費用: ["cost", "price", "fee"],
        價格: ["price", "cost"],
        購物: ["shopping"],
        城市: ["city", "urban"],
        都市: ["city", "urban"],
        濕度: ["humidity"],
        全球: ["global", "world"],
        世界: ["world", "global"],
        速判: ["snap judgment", "quick judgment"],
        判斷: ["judgment", "judgement"],
        秘密: ["secret"],
        即將: ["upcoming"],
        未來: ["future", "upcoming"],

        // Specific content reverse mappings
        人格: ["personality", "mbti"],
        性格: ["personality", "character", "mbti"],
        蘋果: ["apple"],
        香港: ["hongkong", "hk"],
        台灣: ["taiwan", "tw"],
        臺灣: ["taiwan", "tw"],
        古道: ["trail", "path"],
        步道: ["trail", "hiking path"],
        健行: ["hiking"],
        登山: ["hiking", "climbing"],
        徒步: ["hiking", "walking"],
        基因: ["genetics", "gene"],
        遺傳: ["genetics", "heredity"],
        染色體: ["chromosome"],
        性發育: ["dsd", "sexual development"],
      };

      function getSearchTerms(searchTerm) {
        const terms = [searchTerm];
        const lowerTerm = searchTerm.toLowerCase();

        // Add translations if they exist
        if (translationMap[lowerTerm]) {
          terms.push(...translationMap[lowerTerm]);
        }

        // Also check for partial matches in translation keys
        Object.keys(translationMap).forEach((key) => {
          if (key.includes(lowerTerm) || lowerTerm.includes(key)) {
            terms.push(key);
            terms.push(...translationMap[key]);
          }
        });

        // Remove duplicates and return
        return [...new Set(terms)];
      }

      // Initialize all sections as expanded on page load
      document.addEventListener("DOMContentLoaded", function () {
        const sections = ["life", "travel", "learning", "miscellaneous"];
        sections.forEach((sectionName) => {
          const content = document.getElementById(sectionName + "-content");
          content.style.maxHeight = content.scrollHeight + "px";
        });
      });
    </script>
  </body>
</html>
