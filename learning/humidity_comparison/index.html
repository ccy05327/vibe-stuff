<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å…¨çƒæ¿•åº¦äº’å‹•å„€è¡¨æ¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://cdn.plot.ly/plotly-2.32.0.min.js"
      charset="utf-8"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Noto Sans TC", sans-serif;
        background-color: #f8f9fa;
      }
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 900px;
        margin-left: auto;
        margin-right: auto;
        height: 400px;
        max-height: 50vh;
      }
      @media (min-width: 768px) {
        .chart-container {
          height: 500px;
        }
      }
      .map-container {
        position: relative;
        width: 100%;
        height: 450px;
        max-height: 60vh;
      }
      .tab-button.active {
        border-color: #3b82f6;
        color: #3b82f6;
        background-color: #eff6ff;
      }
      .tab-button {
        transition: all 0.2s ease-in-out;
      }
    </style>
  </head>
  <body class="text-slate-800">
    <a
      id="backHomeBtn"
      class="fixed top-6 left-6 z-50 flex items-center px-4 py-2 bg-blue-700 text-white rounded-full shadow-md hover:bg-blue-800 transition-colors text-sm font-semibold"
      style="box-shadow: 0 2px 8px 0 rgba(29, 78, 216, 0.08)"
    >
      <svg
        class="w-4 h-4 mr-2"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M15 19l-7-7 7-7"
        />
      </svg>
      è¿”å›é¦–é 
    </a>
    <script>
      // Dynamically set the homepage link for local and GitHub Pages
      const btn = document.getElementById("backHomeBtn");
      if (
        location.hostname === "localhost" ||
        location.hostname === "127.0.0.1"
      ) {
        btn.href = "/";
      } else {
        btn.href = "/vibe-stuff/";
      }
    </script>
    <div class="container mx-auto p-4 md:p-8">
      <header class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold text-slate-900 mb-2">
          å…¨çƒåŸå¸‚æ¿•åº¦æ¢ç´¢
        </h1>
        <p class="text-lg text-slate-600 max-w-3xl mx-auto">
          æœ¬å„€è¡¨æ¿å°‡åŸå§‹å ±å‘Šæ•¸æ“šè½‰åŒ–ç‚ºäº’å‹•é«”é©—ã€‚è«‹é¸æ“‡å­£ç¯€ï¼Œæ¢ç´¢ä¸–ç•Œä¸»è¦æ½®æ¿•åŸå¸‚èˆ‡å°ç£å°åŒ—ã€åŸºéš†çš„æ¯”è¼ƒã€‚
        </p>
      </header>

      <main>
        <div
          class="flex justify-center items-center mb-8 bg-slate-100 p-3 rounded-xl shadow-inner max-w-sm mx-auto"
        >
          <span class="mr-4 font-semibold text-slate-700">é¸æ“‡å­£ç¯€:</span>
          <div
            class="relative flex w-full max-w-xs items-center rounded-lg bg-white p-1 shadow"
          >
            <button
              id="season-summer"
              class="flex-1 rounded-md py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors"
            >
              å¤å­£
            </button>
            <button
              id="season-winter"
              class="flex-1 rounded-md py-2 text-sm font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition-colors"
            >
              å†¬å­£
            </button>
          </div>
        </div>

        <section
          id="map-section"
          class="mb-12 bg-white p-4 sm:p-6 rounded-2xl shadow-lg"
        >
          <h2 id="map-title" class="text-2xl font-bold mb-4 text-center"></h2>
          <div class="map-container" id="world-map"></div>
          <p class="text-xs text-slate-500 mt-2 text-center">
            åœ¨åœ°åœ–ä¸Šç§»å‹•æ»‘é¼ ä»¥æŸ¥çœ‹å„åŸå¸‚æ•¸æ“šã€‚åœ“åœˆå¤§å°èˆ‡é¡è‰²æ·±æ·ºä»£è¡¨ç›¸å°æ¿•åº¦é«˜ä½ã€‚
          </p>
        </section>

        <div class="w-full max-w-4xl mx-auto mt-4 mb-8">
          <h2 class="text-2xl font-bold mb-6 text-center text-slate-800">
            Audio Overview
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- English Audio -->
            <div
              class="bg-white p-6 rounded-xl shadow-lg border border-blue-100"
            >
              <label
                class="block text-blue-700 font-semibold mb-3 text-center text-lg flex items-center justify-center"
              >
                <span class="text-2xl mr-2">ğŸ‡¬ğŸ‡§</span>
                English Version
              </label>
              <audio
                id="audioPlayerHumidityEN"
                controls
                class="w-full rounded shadow border border-blue-100 bg-white mb-3"
              >
                <source src="(EN) humidity_comparison.mp3" type="audio/mpeg" />
                Your browser does not support the audio element.
              </audio>
              <div class="flex justify-center">
                <label for="speedHumidityEN" class="mr-2 text-sm text-gray-600"
                  >playing speedï¼š</label
                >
                <select
                  id="speedHumidityEN"
                  class="border rounded px-2 py-1 text-sm"
                >
                  <option value="0.75">0.75x</option>
                  <option value="1" selected>1x</option>
                  <option value="1.25">1.25x</option>
                  <option value="1.5">1.5x</option>
                  <option value="2">2x</option>
                </select>
              </div>
            </div>

            <!-- Chinese Audio -->
            <div
              class="bg-white p-6 rounded-xl shadow-lg border border-blue-100"
            >
              <label
                class="block text-blue-700 font-semibold mb-3 text-center text-lg flex items-center justify-center"
              >
                <span class="text-2xl mr-2">ğŸ‡¹ğŸ‡¼</span>
                ä¸­æ–‡ç‰ˆ
              </label>
              <audio
                id="audioPlayerHumidityCH"
                controls
                class="w-full rounded shadow border border-blue-100 bg-white mb-3"
              >
                <source src="(CH) humidity_comparison.wav" type="audio/wav" />
                Your browser does not support the audio element.
              </audio>
              <div class="flex justify-center">
                <label for="speedHumidityCH" class="mr-2 text-sm text-gray-600"
                  >æ’­æ”¾é€Ÿåº¦ï¼š</label
                >
                <select
                  id="speedHumidityCH"
                  class="border rounded px-2 py-1 text-sm"
                >
                  <option value="0.75">0.75x</option>
                  <option value="1" selected>1x</option>
                  <option value="1.25">1.25x</option>
                  <option value="1.5">1.5x</option>
                  <option value="2">2x</option>
                </select>
              </div>
            </div>
          </div>
          <script>
            // English audio speed control
            const audioHumidityEN = document.getElementById(
              "audioPlayerHumidityEN"
            );
            const speedHumidityEN = document.getElementById("speedHumidityEN");
            speedHumidityEN.addEventListener("change", function () {
              audioHumidityEN.playbackRate = parseFloat(this.value);
            });

            // Chinese audio speed control
            const audioHumidityCH = document.getElementById(
              "audioPlayerHumidityCH"
            );
            const speedHumidityCH = document.getElementById("speedHumidityCH");
            speedHumidityCH.addEventListener("change", function () {
              audioHumidityCH.playbackRate = parseFloat(this.value);
            });
          </script>
        </div>

        <section id="comparison-section" class="mb-12">
          <h2
            id="comparison-title"
            class="text-3xl font-bold mb-6 text-center"
          ></h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div
              id="rank-1-card"
              class="p-6 bg-white rounded-2xl shadow-lg border-t-4 border-amber-400"
            ></div>
            <div
              id="rank-2-card"
              class="p-6 bg-white rounded-2xl shadow-lg border-t-4 border-slate-400"
            ></div>
            <div
              id="rank-3-card"
              class="p-6 bg-white rounded-2xl shadow-lg border-t-4 border-orange-600"
            ></div>
          </div>
        </section>

        <section
          id="taiwan-focus"
          class="my-12 p-6 bg-blue-50 border-l-4 border-blue-500 rounded-2xl shadow-lg"
        >
          <h2 class="text-2xl font-bold mb-4 text-blue-900">
            å°ç£ç„¦é»ï¼šå°åŒ—èˆ‡åŸºéš†
          </h2>
          <p class="mb-4 text-slate-700">
            æ­¤éƒ¨åˆ†å°ˆé–€æ¯”è¼ƒå°åŒ—èˆ‡åŸºéš†åœ¨æ‰€é¸å­£ç¯€çš„æ¿•åº¦è¡¨ç¾ï¼Œä¸¦èªªæ˜å…¶ç¨ç‰¹çš„æ°£å€™æˆå› ã€‚å°ç£åŒ—éƒ¨çš„æ¿•åº¦åœ¨å…¨çƒå‰¯ç†±å¸¶åœ°å€ä¸­æ¥µç‚ºçªå‡ºã€‚
          </p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div id="taipei-card" class="p-6 bg-white rounded-xl shadow"></div>
            <div id="keelung-card" class="p-6 bg-white rounded-xl shadow"></div>
          </div>
        </section>

        <section
          id="chart-section"
          class="mb-12 bg-white p-4 sm:p-6 rounded-2xl shadow-lg"
        >
          <h2 id="chart-title" class="text-2xl font-bold mb-4 text-center"></h2>
          <div class="chart-container">
            <canvas id="humidity-chart"></canvas>
          </div>
        </section>

        <section id="knowledge-section">
          <h2 class="text-3xl font-bold mb-6 text-center">æ¿•åº¦çŸ¥è­˜åº«</h2>
          <div class="max-w-4xl mx-auto">
            <div class="flex justify-center border-b border-slate-200 mb-6">
              <button
                data-tab="what-is-humidity"
                class="tab-button px-6 py-3 font-semibold border-b-2"
              >
                æ¿•åº¦æ˜¯ä»€éº¼ï¼Ÿ
              </button>
              <button
                data-tab="global-drivers"
                class="tab-button px-6 py-3 font-semibold border-b-2"
              >
                å…¨çƒé©…å‹•å› ç´ 
              </button>
              <button
                data-tab="taiwan-uniqueness"
                class="tab-button px-6 py-3 font-semibold border-b-2"
              >
                å°ç£çš„ç¨ç‰¹æ€§
              </button>
            </div>
            <div
              id="tab-content"
              class="bg-white p-6 rounded-2xl shadow-lg min-h-[250px]"
            >
              <div id="what-is-humidity-content" class="tab-pane">
                <h3 class="text-xl font-bold mb-2">è¡¡é‡ã€Œæ¿•é»æ„Ÿã€çš„ç§‘å­¸</h3>
                <p class="text-slate-600">
                  è©•ä¼°åŸå¸‚çš„æ½®æ¿•ç¨‹åº¦ä¸åƒ…æ˜¯çœ‹å–®ä¸€æ•¸å­—ã€‚æ°£å€™å­¸å®¶ä½¿ç”¨å¤šç¨®æŒ‡æ¨™ä¾†æä¾›å…¨é¢çš„åœ–åƒï¼š
                </p>
                <ul class="list-disc list-inside mt-4 space-y-2">
                  <li>
                    <strong>ç›¸å°æ¿•åº¦ (RH):</strong>
                    æœ€å¸¸è¦‹çš„æŒ‡æ¨™ï¼Œè¡¨ç¤ºç©ºæ°£ä¸­æ°´æ°£ç›¸å°æ–¼é£½å’Œé»çš„ç™¾åˆ†æ¯”ã€‚ä½†å®ƒå¯èƒ½å…·èª¤å°æ€§ï¼Œå› ç‚ºå†·ç©ºæ°£å³ä½¿ç›¸å°æ¿•åº¦100%ï¼Œå¯¦éš›æ°´æ°£å«é‡ä¹Ÿå¾ˆå°‘ã€‚
                  </li>
                  <li>
                    <strong>éœ²é»æº«åº¦:</strong>
                    è¡¡é‡ç©ºæ°£ä¸­çµ•å°æ°´æ°£å«é‡çš„æ›´ç²¾ç¢ºæŒ‡æ¨™ã€‚éœ²é»è¶Šé«˜ï¼Œé«”æ„Ÿè¶Šã€Œæ¿•é»ã€ã€‚ç•¶éœ²é»è¶…éæ”æ°20Â°Cæ™‚ï¼Œå¤§å¤šæ•¸äººæœƒæ„Ÿåˆ°ä¸é©ã€‚
                  </li>
                  <li>
                    <strong>ç†±æŒ‡æ•¸ (é«”æ„Ÿæº«åº¦):</strong>
                    çµåˆæ°£æº«å’Œæ¿•åº¦ï¼Œä¼°ç®—äººé«”å°ç†±çš„çœŸå¯¦æ„Ÿå—ï¼Œæ˜¯ç†è§£æ¿•ç†±å¤©æ°£å°äººé«”å½±éŸ¿çš„å¯¦ç”¨å·¥å…·ã€‚
                  </li>
                </ul>
              </div>
              <div id="global-drivers-content" class="tab-pane hidden">
                <h3 class="text-xl font-bold mb-2">å¡‘é€ å…¨çƒæ¿•åº¦çš„åŠ›é‡</h3>
                <p class="text-slate-600">
                  åœ°çƒä¸Šæœ€æ½®æ¿•çš„åœ°æ–¹é€šå¸¸æ˜¯ä¸‰å€‹é—œéµåœ°ç†å› ç´ çš„äº¤æœƒé»ï¼š
                </p>
                <ul class="list-disc list-inside mt-4 space-y-2">
                  <li>
                    <strong>ç†±å¸¶å¼•æ“ (ç·¯åº¦èˆ‡æ°´åŸŸ):</strong>
                    èµ¤é“é™„è¿‘å¼·çƒˆçš„å¤ªé™½è¼»å°„è’¸ç™¼äº†å¤§é‡æµ·æ°´ã€‚æº«æš–çš„ç©ºæ°£å¯ä»¥å®¹ç´æ›´å¤šçš„æ°´æ°£ï¼Œé€™æ˜¯ç†±å¸¶åœ°å€é«˜æ¿•åº¦çš„ç‰©ç†åŸºç¤ã€‚
                  </li>
                  <li>
                    <strong>æ°´æ°£é«˜é€Ÿå…¬è·¯ (å…¨çƒé¢¨ç³»):</strong>
                    å­£é¢¨ç³»çµ±ç­‰å¤§è¦æ¨¡é¢¨ç³»ï¼Œå¦‚åŒå·¨å¤§çš„é‹è¼¸å¸¶ï¼Œå°‡æµ·æ´‹ä¸Šçš„æ¿•æ°£è¼¸é€åˆ°å¤§é™¸ï¼Œä¸»å°äº†äºæ´²ç­‰åœ°çš„æ°£å€™ã€‚
                  </li>
                  <li>
                    <strong>å±€éƒ¨é›•å¡‘å®¶ (åœ°å½¢):</strong>
                    å±±è„ˆå¯ä»¥é˜»æ“‹ä¸¦æŠ¬å‡æ¿•æ½¤æ°£æµï¼Œå°è‡´è¿é¢¨å¡é™é›¨å’Œæ¿•åº¦æ€¥åŠ‡å¢åŠ ï¼ˆå¦‚åŸºéš†ï¼‰ï¼›è€Œç›†åœ°åœ°å½¢å‰‡æœƒå°‡æ¿•æ°£å›°ä½ï¼ˆå¦‚å°åŒ—ï¼‰ã€‚
                  </li>
                </ul>
              </div>
              <div id="taiwan-uniqueness-content" class="tab-pane hidden">
                <h3 class="text-xl font-bold mb-2">ç‚ºä½•å°ç£åŒ—éƒ¨å¦‚æ­¤æ½®æ¿•ï¼Ÿ</h3>
                <p class="text-slate-600">
                  å°åŒ—å’ŒåŸºéš†çš„æ¥µç«¯æ¿•åº¦æ˜¯ç”±å…¶ç¨ç‰¹çš„åœ°ç†ä½ç½®å’Œåœ°å½¢å…±åŒé€ æˆçš„ï¼š
                </p>
                <ul class="list-disc list-inside mt-4 space-y-2">
                  <li>
                    <strong>åŸºéš† - é›¨æ¸¯:</strong>
                    åœ¨å†¬å­£ï¼Œå¼·å‹çš„æ±åŒ—å­£é¢¨å¾æµ·æ´‹å¸¶ä¾†å……æ»¿æ°´æ°£çš„ç©ºæ°£ã€‚ç•¶æ°£æµæ’ä¸ŠåŸºéš†å¾Œæ–¹çš„å±±è„ˆæ™‚ï¼Œè¢«è¿«æŠ¬å‡ã€å†·å»ä¸¦å‡çµæˆé›¨ï¼Œä½¿å…¶æˆç‚ºä¸–ç•Œç´šçš„å†¬å­£æ½®æ¿•åŸå¸‚ã€‚å…¶å†¬å­£å¹³å‡ç›¸å°æ¿•åº¦
                    (85%) ç”šè‡³å¯èˆ‡èµ¤é“åŸå¸‚æ–°åŠ å¡çš„é›¨å­£ç›¸åª²ç¾ã€‚
                  </li>
                  <li>
                    <strong>å°åŒ— - æ½®æ¿•ç›†åœ°:</strong>
                    å°åŒ—è¢«ç¾¤å±±ç’°ç¹ï¼Œå½¢æˆä¸€å€‹ã€Œç¢—ç‹€ã€åœ°å½¢ã€‚é€™ç¨®ç›†åœ°æ•ˆæ‡‰æœƒå°‡æ¿•æ°£å’Œæ±¡æŸ“ç‰©å›°åœ¨åŸå¸‚ä¸Šç©ºï¼Œé›£ä»¥æ“´æ•£ï¼Œå°è‡´å¤å­£æ‚¶ç†±ã€å†¬å­£æ¿•å†·ã€‚
                  </li>
                  <li>
                    <strong>ä¹¾ç‡¥åŒ–æ‚–è«–:</strong>
                    å„˜ç®¡ç•¶å‰æ¥µåº¦æ½®æ¿•ï¼Œä½†æœ‰ç ”ç©¶æŒ‡å‡ºå°åŒ—éƒ½æœƒå€æ­£è™•æ–¼é•·æœŸã€Œä¹¾ç‡¥åŒ–ã€è¶¨å‹¢ã€‚é€™æ„å‘³è‘—æœªä¾†å¯èƒ½é¢è‡¨æ›´æ¥µç«¯çš„æš´é›¨å’Œæ›´åš´å³»çš„ä¹¾æ—±é¢¨éšªä¸¦å­˜çš„æŒ‘æˆ°ã€‚
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </section>
      </main>

      <footer class="text-center mt-12 pt-8 border-t border-slate-200">
        <p class="text-sm text-slate-500">
          è³‡æ–™ä¾†æºï¼šå…¨çƒé«˜æ¿•åº¦åŸå¸‚æ¯”è¼ƒåˆ†æå ±å‘Šã€‚æ•¸æ“šç¶œåˆè‡ªå¤šåœ‹æ°£è±¡æ©Ÿæ§‹åŠå­¸è¡“ç ”ç©¶ã€‚
        </p>
        <p class="text-xs text-slate-400 mt-1">äº’å‹•å¼æ‡‰ç”¨ç¨‹å¼ç”± AI ç”Ÿæˆ</p>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const cityData = [
          {
            city: "å°åŒ—",
            country: "å°ç£",
            lat: 25.0375,
            lon: 121.5272,
            summer_rh: 75,
            winter_rh: 79,
            desc: "ç›†åœ°åœ°å½¢ä½¿æ¿•æ°£ä¸æ˜“æ“´æ•£ï¼Œå¤å­£æ‚¶ç†±ã€å†¬å­£æ¿•å†·ã€‚",
          },
          {
            city: "åŸºéš†",
            country: "å°ç£",
            lat: 25.1282,
            lon: 121.7438,
            summer_rh: 80,
            winter_rh: 85,
            desc: "æ±åŒ—å­£é¢¨å—åœ°å½¢æŠ¬å‡ï¼Œé€ æˆä¸–ç•Œç´šçš„å†¬å­£æ¿•åº¦ã€‚",
          },
          {
            city: "æ–°åŠ å¡",
            country: "æ–°åŠ å¡",
            lat: 1.2903,
            lon: 103.852,
            summer_rh: 82,
            winter_rh: 85,
            desc: "ä½æ–¼èµ¤é“ï¼Œå—é›™é‡å­£é¢¨å½±éŸ¿ï¼Œå…¨å¹´é«˜æ¿•ã€‚",
          },
          {
            city: "é›…åŠ é”",
            country: "å°å°¼",
            lat: -6.2088,
            lon: 106.8456,
            summer_rh: 78,
            winter_rh: 85,
            desc: "èµ¤é“æµ·æ´‹å¤§é™¸æ•ˆæ‡‰ï¼Œé›¨å­£æ¿•åº¦æ¥µé«˜ã€‚",
          },
          {
            city: "å‰éš†å¡",
            country: "é¦¬ä¾†è¥¿äº",
            lat: 3.139,
            lon: 101.6869,
            summer_rh: 78,
            winter_rh: 81,
            desc: "ç†±å¸¶é›¨æ—æ°£å€™ï¼Œå¹´å‡æ¿•åº¦è¶…é80%ã€‚",
          },
          {
            city: "ç‘ªç‘™æ–¯",
            country: "å·´è¥¿",
            lat: -3.119,
            lon: -60.0217,
            summer_rh: 77,
            winter_rh: 86,
            desc: "äºé¦¬éœé›¨æ—è’¸ç™¼æ•£ä½œç”¨æä¾›å·¨é‡æ°´æ°£ã€‚",
          },
          {
            city: "é”çˆ¾æ–‡",
            country: "æ¾³æ´²",
            lat: -12.4634,
            lon: 130.8456,
            summer_rh: 60,
            winter_rh: 81,
            desc: "ç†±å¸¶è½åŸæ°£å€™ï¼Œæ¿•å­£æ¥µæ¿•ï¼Œä¹¾å­£ä¹¾ç‡¥ã€‚",
          },
          {
            city: "å³‡é‡Œå·´æ¿",
            country: "å°å°¼",
            lat: -1.2659,
            lon: 116.8285,
            summer_rh: 84,
            winter_rh: 86,
            desc: "ä½æ–¼å©†ç¾…æ´²ï¼Œå…¨å¹´è™•æ–¼æ¥µç«¯æ¿•åº¦ç‹€æ…‹ã€‚",
          },
          {
            city: "å¡å¡”èµ«ç´",
            country: "å“¥å€«æ¯”äº",
            lat: 10.3932,
            lon: -75.4832,
            summer_rh: 83,
            winter_rh: 84,
            desc: "å—æº«æš–çš„åŠ å‹’æ¯”æµ·å½±éŸ¿ï¼Œå…¨å¹´æ¿•ç†±ã€‚",
          },
          {
            city: "è‡ªç”±å¸‚",
            country: "åŠ å½­",
            lat: 0.4162,
            lon: 9.4673,
            summer_rh: 86,
            winter_rh: 88,
            desc: "éæ´²èµ¤é“æµ·å²¸åŸå¸‚ï¼Œå…¨å¹´è™•æ–¼ä¸èˆ’é©æ¿•åº¦ã€‚",
          },
          {
            city: "æª€é¦™å±±",
            country: "ç¾åœ‹",
            lat: 21.3069,
            lon: -157.8583,
            summer_rh: 64,
            winter_rh: 69,
            desc: "ç†±å¸¶æµ·æ´‹æ°£å€™ï¼Œæ¿•åº¦ç›¸å°æº«å’Œã€‚",
          },
        ];

        let currentSeason = "summer";
        let humidityChart = null;

        const seasonSummerBtn = document.getElementById("season-summer");
        const seasonWinterBtn = document.getElementById("season-winter");

        function updateSeasonToggleUI() {
          if (currentSeason === "summer") {
            seasonSummerBtn.classList.add("bg-blue-500", "text-white");
            seasonSummerBtn.classList.remove("bg-white", "text-slate-800");
            seasonWinterBtn.classList.remove("bg-blue-500", "text-white");
            seasonWinterBtn.classList.add("bg-white", "text-slate-800");
          } else {
            seasonWinterBtn.classList.add("bg-blue-500", "text-white");
            seasonWinterBtn.classList.remove("bg-white", "text-slate-800");
            seasonSummerBtn.classList.remove("bg-blue-500", "text-white");
            seasonSummerBtn.classList.add("bg-white", "text-slate-800");
          }
        }

        function renderWorldMap() {
          const seasonKey = `${currentSeason}_rh`;
          const locations = cityData.map((c) => c.city);
          const humidityValues = cityData.map((c) => c[seasonKey]);
          const lats = cityData.map((c) => c.lat);
          const lons = cityData.map((c) => c.lon);
          const text = cityData.map(
            (c) => `${c.city}, ${c.country}<br>ç›¸å°æ¿•åº¦: ${c[seasonKey]}%`
          );

          const data = [
            {
              type: "scattergeo",
              lat: lats,
              lon: lons,
              hoverinfo: "text",
              text: text,
              marker: {
                size: humidityValues.map((h) => h / 3),
                color: humidityValues,
                colorscale: "Blues",
                reversescale: true,
                cmin: 50,
                cmax: 90,
                colorbar: {
                  title: "ç›¸å°æ¿•åº¦ (%)",
                  ticksuffix: "%",
                },
                line: {
                  color: "black",
                  width: 0.5,
                },
              },
            },
          ];

          const layout = {
            geo: {
              scope: "world",
              projection: { type: "natural earth1" },
              showland: true,
              landcolor: "rgb(243, 243, 243)",
              countrycolor: "rgb(204, 204, 204)",
              bgcolor: "rgba(0,0,0,0)",
            },
            margin: { l: 0, r: 0, t: 0, b: 0 },
            paper_bgcolor: "rgba(0,0,0,0)",
            plot_bgcolor: "rgba(0,0,0,0)",
          };

          Plotly.newPlot("world-map", data, layout, {
            responsive: true,
            displayModeBar: false,
          });
          document.getElementById("map-title").textContent = `å…¨çƒä¸»è¦åŸå¸‚${
            currentSeason === "summer" ? "å¤å­£" : "å†¬å­£"
          }å¹³å‡ç›¸å°æ¿•åº¦åˆ†ä½ˆ`;
        }

        function renderBarChart() {
          const ctx = document
            .getElementById("humidity-chart")
            .getContext("2d");
          const seasonKey = `${currentSeason}_rh`;
          const sortedData = [...cityData].sort(
            (a, b) => b[seasonKey] - a[seasonKey]
          );
          const labels = sortedData.map((c) => `${c.city}, ${c.country}`);
          const data = sortedData.map((c) => c[seasonKey]);

          const chartData = {
            labels: labels,
            datasets: [
              {
                label: "å¹³å‡ç›¸å°æ¿•åº¦ (%)",
                data: data,
                backgroundColor: sortedData.map((c) =>
                  c.country === "å°ç£"
                    ? "rgba(255, 99, 132, 0.6)"
                    : "rgba(54, 162, 235, 0.6)"
                ),
                borderColor: sortedData.map((c) =>
                  c.country === "å°ç£"
                    ? "rgba(255, 99, 132, 1)"
                    : "rgba(54, 162, 235, 1)"
                ),
                borderWidth: 1,
              },
            ],
          };

          if (humidityChart) {
            humidityChart.data = chartData;
            humidityChart.update();
          } else {
            humidityChart = new Chart(ctx, {
              type: "bar",
              data: chartData,
              options: {
                indexAxis: "y",
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: false },
                  tooltip: {
                    callbacks: {
                      label: function (context) {
                        return `ç›¸å°æ¿•åº¦: ${context.raw}%`;
                      },
                    },
                  },
                },
                scales: {
                  x: {
                    beginAtZero: false,
                    min: 50,
                    title: {
                      display: true,
                      text: "å¹³å‡ç›¸å°æ¿•åº¦ (%)",
                    },
                  },
                },
              },
            });
          }
          document.getElementById("chart-title").textContent = `${
            currentSeason === "summer" ? "å¤å­£" : "å†¬å­£"
          }æ¿•åº¦æ’è¡Œæ¦œ`;
        }

        function updateComparisonCards() {
          const seasonKey = `${currentSeason}_rh`;
          const sortedData = [...cityData]
            .filter((c) => c.country !== "å°ç£")
            .sort((a, b) => b[seasonKey] - a[seasonKey]);

          document.getElementById("comparison-title").textContent = `${
            currentSeason === "summer" ? "å¤å­£" : "å†¬å­£"
          }æ¿•åº¦äº®é»`;

          const cards = ["rank-1-card", "rank-2-card", "rank-3-card"];
          const ranks = ["ğŸ¥‡ ç¬¬ä¸€å", "ğŸ¥ˆ ç¬¬äºŒå", "ğŸ¥‰ ç¬¬ä¸‰å"];

          for (let i = 0; i < 3; i++) {
            const city = sortedData[i];
            const card = document.getElementById(cards[i]);
            card.innerHTML = `
                <p class="text-sm font-bold text-amber-500 mb-1">${ranks[i]}</p>
                <h3 class="text-2xl font-bold">${city.city}</h3>
                <p class="text-slate-500 mb-3">${city.country}</p>
                <p class="text-4xl font-bold text-slate-800">${city[seasonKey]}<span class="text-2xl text-slate-500">%</span></p>
                <p class="text-sm text-slate-600 mt-2">${city.desc}</p>
            `;
          }
        }

        function updateTaiwanCards() {
          const seasonKey = `${currentSeason}_rh`;
          const taipei = cityData.find((c) => c.city === "å°åŒ—");
          const keelung = cityData.find((c) => c.city === "åŸºéš†");

          document.getElementById("taipei-card").innerHTML = `
            <h3 class="text-xl font-bold">å°åŒ—</h3>
            <p class="text-4xl font-bold my-2">${taipei[seasonKey]}<span class="text-2xl text-slate-500">%</span></p>
            <p class="text-sm text-slate-600">${taipei.desc}</p>
        `;
          document.getElementById("keelung-card").innerHTML = `
            <h3 class="text-xl font-bold">åŸºéš†</h3>
            <p class="text-4xl font-bold my-2">${keelung[seasonKey]}<span class="text-2xl text-slate-500">%</span></p>
            <p class="text-sm text-slate-600">${keelung.desc}</p>
        `;
        }

        function switchSeason(season) {
          currentSeason = season;
          updateAll();
        }

        function setupTabs() {
          const tabButtons = document.querySelectorAll(".tab-button");
          const tabPanes = document.querySelectorAll(".tab-pane");

          tabButtons.forEach((button) => {
            button.addEventListener("click", () => {
              const tabId = button.dataset.tab;

              tabButtons.forEach((btn) => btn.classList.remove("active"));
              button.classList.add("active");

              tabPanes.forEach((pane) => {
                if (pane.id === `${tabId}-content`) {
                  pane.classList.remove("hidden");
                } else {
                  pane.classList.add("hidden");
                }
              });
            });
          });
          document
            .querySelector('.tab-button[data-tab="what-is-humidity"]')
            .click();
        }

        function updateAll() {
          updateSeasonToggleUI();
          renderWorldMap();
          renderBarChart();
          updateComparisonCards();
          updateTaiwanCards();
        }

        seasonSummerBtn.addEventListener("click", () => switchSeason("summer"));
        seasonWinterBtn.addEventListener("click", () => switchSeason("winter"));

        updateAll();
        setupTabs();
      });
    </script>
  </body>
</html>
