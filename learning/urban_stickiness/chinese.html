<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>äº’å‹•å¼å ±å‘Šï¼šè§£æ§‹å…¨çƒåŸå¸‚ã€Œé»è‘—åº¦ã€(å®Œæ•´ç‰ˆ)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <script
      src="https://cdn.plot.ly/plotly-2.32.0.min.js"
      charset="utf-8"
    ></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Noto Sans TC", sans-serif;
        background-color: #fdfbf8;
        color: #383838;
      }
      .text-balance {
        text-wrap: balance;
      }
      .chart-container {
        position: relative;
        width: 100%;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        height: 500px;
        max-height: 70vh;
      }
      .scatter-chart-container {
        position: relative;
        width: 100%;
        max-width: 700px;
        margin-left: auto;
        margin-right: auto;
        height: 500px;
        max-height: 60vh;
      }
      .map-container {
        position: relative;
        width: 100%;
        height: 450px;
        max-height: 60vh;
      }
      .factor-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .factor-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .nav-button {
        transition: color 0.3s ease, border-color 0.3s ease;
      }
      .nav-button.active {
        color: #4a6c8b;
        border-color: #4a6c8b;
      }
      .nav-button:not(.active):hover {
        color: #6b8baa;
      }
    </style>
  </head>
  <body class="antialiased">
    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
      <nav
        class="container mx-auto px-6 py-3 flex justify-between items-center"
      >
        <h1 class="text-xl md:text-2xl font-bold text-[#3E5C76]">
          åŸå¸‚ç£å¸åŠ›å ±å‘Š
        </h1>
        <div
          class="hidden md:flex space-x-4 lg:space-x-6 text-gray-600 text-sm lg:text-base"
        >
          <a
            href="#fact-check"
            class="nav-button pb-1 border-b-2 border-transparent"
            >äº‹å¯¦æŸ¥æ ¸</a
          >
          <a
            href="#dashboard"
            class="nav-button pb-1 border-b-2 border-transparent"
            >æ ¸å¿ƒå„€è¡¨æ¿</a
          >
          <a
            href="#ranking"
            class="nav-button pb-1 border-b-2 border-transparent"
            >æ•¸æ“šæ’å</a
          >
          <a
            href="#generation"
            class="nav-button pb-1 border-b-2 border-transparent"
            >ä¸–ä»£è§€é»</a
          >
          <a
            href="#insights"
            class="nav-button pb-1 border-b-2 border-transparent"
            >æœªä¾†å•Ÿç¤º</a
          >
        </div>
      </nav>
    </header>
    <!-- Audio Section -->
    <section class="bg-white/60 backdrop-blur-sm border-b border-gray-100 py-6">
      <div class="container mx-auto px-6">
        <div class="flex justify-start mb-4">
          <a
            href="../../index.html"
            class="bg-[#F0F4F8]/90 text-[#3E5C76] px-4 py-2 rounded-full shadow-lg border border-[#C5D4E2] backdrop-blur-sm flex items-center hover:bg-[#E5EDF5] hover:text-[#2D4A63] transition-all duration-200"
            style="font-size: 0.95rem; font-weight: 500"
          >
            <span class="mr-2">â†</span> è¿”å›é¦–é 
          </a>
        </div>
        <div class="max-w-2xl mx-auto">
          <div
            class="bg-white p-6 rounded-xl shadow-md border border-[#C5D4E2]"
          >
            <label
              class="block text-[#3E5C76] font-semibold mb-3 text-center text-lg flex items-center justify-center"
            >
              <span class="text-2xl mr-2">ğŸ§</span>
              ä¸­æ–‡å°è¦½
            </label>
            <audio
              id="audioPlayerStickiness"
              controls
              class="w-full rounded shadow border border-[#C5D4E2] bg-white mb-3"
            >
              <source src="(CH) urban_stickiness.wav" type="audio/mpeg" />
              Your browser does not support the audio element.
            </audio>
            <div class="flex justify-center">
              <label for="speedStickiness" class="mr-2 text-sm text-gray-600"
                >æ’­æ”¾é€Ÿåº¦ï¼š</label
              >
              <select
                id="speedStickiness"
                class="border border-[#C5D4E2] rounded px-2 py-1 text-sm"
              >
                <option value="0.75">0.75x</option>
                <option value="1" selected>1x</option>
                <option value="1.25">1.25x</option>
                <option value="1.5">1.5x</option>
                <option value="2">2x</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </section>
    <main class="container mx-auto px-6 py-12">
      <section id="fact-check" class="text-center mb-20 md:mb-24 scroll-mt-24">
        <h2
          class="text-3xl md:text-4xl font-bold text-[#3E5C76] mb-4 text-balance"
        >
          ç¤¾ç¾¤ç˜‹å‚³çš„åŸå¸‚æ’åï¼Œæ˜¯çœŸçš„å—ï¼Ÿ
        </h2>
        <p class="max-w-3xl mx-auto text-gray-600 mb-12 text-balance">
          è¿‘æœŸä¸€å‰‡é—œæ–¼ã€ŒåŸå¸‚é»è‘—åº¦ã€çš„è²¼æ–‡åœ¨ç¤¾ç¾¤åª’é«”ä¸Šå»£æ³›æµå‚³ï¼Œä½†å…¶æ•¸æ“šèˆ‡
          Gensler ç ”ç©¶é™¢çš„å®˜æ–¹å ±å‘Šå­˜åœ¨é¡¯è‘—å·®ç•°ã€‚æœ¬éƒ¨åˆ†å°‡ç›´æ¥æ¯”å°ï¼Œé‡æ¸…äº‹å¯¦ã€‚
        </p>
        <div class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
          <div class="bg-white p-6 rounded-xl shadow-md border border-gray-200">
            <h3 class="text-xl font-bold text-red-600 mb-4">âŒ ç¶²è·¯æµå‚³ç‰ˆæœ¬</h3>
            <div class="space-y-3 text-left">
              <p class="text-lg"><strong>1. å°åŒ—:</strong> 64%</p>
              <p class="text-lg"><strong>2. èƒ¡å¿—æ˜å¸‚:</strong> 61%</p>
              <p class="text-lg"><strong>3. æ–°åŠ å¡:</strong> 59%</p>
            </div>
            <p class="mt-4 text-sm text-gray-500">
              çµè«–ï¼šæ•¸æ“šèˆ‡æ’åå‡æœ‰èª¤ï¼Œä¸”èƒ¡å¿—æ˜å¸‚æœªé€²å…¥å…¨çƒå‰åã€‚
            </p>
          </div>
          <div
            class="bg-white p-6 rounded-xl shadow-lg border-2 border-[#4A6C8B]"
          >
            <h3 class="text-xl font-bold text-green-700 mb-4">
              âœ… Gensler å®˜æ–¹å ±å‘Š
            </h3>
            <div class="space-y-3 text-left">
              <p class="text-lg"><strong>1. å°åŒ—:</strong> 85%</p>
              <p class="text-lg"><strong>2. é¦–çˆ¾:</strong> 82%</p>
              <p class="text-lg"><strong>3. æ–°åŠ å¡:</strong> 80%</p>
            </div>
            <p class="mt-4 text-sm text-gray-500">
              çµè«–ï¼šçœŸå¯¦æ•¸æ“šé é«˜æ–¼å‚³èï¼Œæ’åçµ„åˆä¹Ÿä¸åŒã€‚
            </p>
          </div>
        </div>
      </section>

      <hr class="my-20 md:my-24 border-gray-200" />

      <section id="dashboard" class="mb-20 md:mb-24 scroll-mt-24">
        <div class="text-center mb-12">
          <h2
            class="text-3xl md:text-4xl font-bold text-[#3E5C76] mb-4 text-balance"
          >
            æ ¸å¿ƒå„€è¡¨æ¿ï¼šå¸å¼•åŠ› vs. é»è‘—åº¦
          </h2>
          <p class="max-w-3xl mx-auto text-gray-600 text-balance">
            å ±å‘Šçš„ç²¾é«“åœ¨æ–¼å€åˆ†å¸å¼•äººå€‘ã€Œé·å…¥ã€çš„å‹™å¯¦å› ç´ ï¼ˆå¸å¼•åŠ›ï¼‰èˆ‡è®“ä»–å€‘ã€Œç•™ä¸‹ã€çš„æƒ…æ„Ÿå› ç´ ï¼ˆé»è‘—åº¦ï¼‰ã€‚é€™å€‹äº’å‹•å„€è¡¨æ¿å°‡å…¨çƒä¸»è¦åŸå¸‚ç½®æ–¼å››å€‹è±¡é™ä¸­ï¼Œæ­ç¤ºå®ƒå€‘çš„çœŸå¯¦æ¨£è²Œã€‚
          </p>
        </div>
        <div
          class="bg-white p-4 sm:p-6 md:p-8 rounded-xl shadow-lg border border-gray-200"
        >
          <div class="scatter-chart-container">
            <canvas id="attractionStickinessChart"></canvas>
          </div>
          <div
            class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 text-xs text-center"
          >
            <div class="p-3 bg-red-50 text-red-800 rounded-lg">
              <h4 class="font-bold">å‹•ç›ªä¹‹åŸ (Volatile)</h4>
              <p>é«˜å¸å¼•åŠ›, ä½é»è‘—åº¦</p>
            </div>
            <div class="p-3 bg-green-50 text-green-800 rounded-lg">
              <h4 class="font-bold">ç£åŠ›ä¹‹åŸ (Magnetic)</h4>
              <p>é«˜å¸å¼•åŠ›, é«˜é»è‘—åº¦</p>
            </div>
            <div class="p-3 bg-yellow-50 text-yellow-800 rounded-lg">
              <h4 class="font-bold">æ½›åŠ›ä¹‹åŸ (Untapped)</h4>
              <p>ä½å¸å¼•åŠ›, é«˜é»è‘—åº¦</p>
            </div>
            <div class="p-3 bg-gray-100 text-gray-800 rounded-lg">
              <h4 class="font-bold">åœæ»¯ä¹‹åŸ (Stagnant)</h4>
              <p>ä½å¸å¼•åŠ›, ä½é»è‘—åº¦</p>
            </div>
          </div>
        </div>
      </section>

      <hr class="my-20 md:my-24 border-gray-200" />

      <section id="ranking" class="mb-20 md:mb-24 scroll-mt-24">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-bold text-[#3E5C76] mb-4">
            å…¨çƒ Top 20ã€Œæœ€é»ã€åŸå¸‚äº’å‹•æ’å
          </h2>
          <p class="max-w-3xl mx-auto text-gray-600 text-balance">
            ä»¥ä¸‹æ˜¯å®˜æ–¹å ±å‘Šä¸­ï¼Œå±…æ°‘ç•™å­˜æ„é¡˜æœ€é«˜çš„äºŒåå¤§åŸå¸‚ã€‚é»æ“Šåœ–è¡¨ä¸­çš„åŸå¸‚ï¼Œå³å¯åœ¨åœ°åœ–å’Œä¸‹æ–¹çš„åˆ†æå€å¡ŠæŸ¥çœ‹æ›´å¤šè©³ç´°è³‡è¨Šã€‚
          </p>
        </div>
        <div
          class="bg-white p-4 sm:p-6 md:p-8 rounded-xl shadow-lg border border-gray-200"
        >
          <div class="chart-container" style="height: 700px; max-height: 80vh">
            <canvas id="stickyCitiesChart"></canvas>
          </div>
        </div>
      </section>

      <section id="deep-dive" class="scroll-mt-24">
        <div class="grid lg:grid-cols-5 gap-8">
          <div
            class="lg:col-span-2 bg-white p-8 rounded-xl shadow-lg border border-gray-200 h-full"
          >
            <h3 class="text-2xl font-bold text-[#3E5C76] mb-1">
              æ·±åº¦å‰–æï¼š<span id="cityName"></span>
            </h3>
            <p class="text-gray-500 mb-4">
              æ’å <span id="cityRank"></span> |
              <span id="cityPercentage"></span> çš„å±…æ°‘è¡¨ç¤ºä¸å¤ªå¯èƒ½æ¬é›¢
            </p>
            <div
              id="cityDescription"
              class="text-gray-700 space-y-4 text-balance"
            ></div>
          </div>
          <div
            class="lg:col-span-3 bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-200"
          >
            <div class="map-container">
              <div id="map"></div>
            </div>
          </div>
        </div>
      </section>

      <hr class="my-20 md:my-24 border-gray-200" />

      <section id="generation" class="mb-20 md:mb-24 scroll-mt-24">
        <div class="text-center mb-12">
          <h2
            class="text-3xl md:text-4xl font-bold text-[#3E5C76] mb-4 text-balance"
          >
            ä¸–ä»£è§€é»ï¼šZ ä¸–ä»£æƒ³è¦ä»€éº¼ï¼Ÿ
          </h2>
          <p class="max-w-3xl mx-auto text-gray-600 text-balance">
            å ±å‘Šæ­ç¤ºäº† Z ä¸–ä»£ (18-25æ­²)
            èˆ‡å…¶ä»–ä¸–ä»£åœ¨åŸå¸‚åƒ¹å€¼è§€ä¸Šçš„é¡¯è‘—å·®ç•°ã€‚ä»–å€‘æ›´çœ‹é‡å‹•æ…‹çš„é«”é©—ï¼Œè€Œééœæ…‹çš„ç©©å®šï¼Œé€™å°åŸå¸‚çš„æœªä¾†ç™¼å±•è‡³é—œé‡è¦ã€‚
          </p>
        </div>
        <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
          <div
            class="factor-card bg-white p-6 rounded-xl shadow-md border border-gray-200"
          >
            <h3 class="text-xl font-bold mb-3 text-[#4A6C8B]">1. é«”é©—å„ªå…ˆ</h3>
            <p class="text-gray-600">
              Z
              ä¸–ä»£æ˜¯å”¯ä¸€å°‡ã€Œæœ‰è¶£çš„é«”é©—ã€æ’åœ¨ã€Œå¯è² æ“”æ€§ã€ä¹‹ä¸Šçš„ç¾¤é«”ã€‚ä»–å€‘æ¸´æœ›åŸå¸‚èƒ½æä¾›æºæºä¸æ–·çš„æ–°é®®æ„Ÿã€ç¾é£Ÿå’Œå¨›æ¨‚æ´»å‹•ã€‚
            </p>
          </div>
          <div
            class="factor-card bg-white p-6 rounded-xl shadow-md border border-gray-200"
          >
            <h3 class="text-xl font-bold mb-3 text-[#4A6C8B]">2. ç¤¾ç¾¤é€£çµ</h3>
            <p class="text-gray-600">
              ä»–å€‘é«˜åº¦é‡è¦–èˆ‡æœ‹å‹å’Œå®¶äººçš„é€£çµã€‚èƒ½å¤ è¼•æ˜“è¦‹åˆ°æ‰€æ„›ä¹‹äººï¼Œæ˜¯ä»–å€‘é¸æ“‡ç•™ä¸‹çš„é—œéµå› ç´ ï¼Œé‡è¦æ€§ç”šè‡³è¶…éäº†äº‹æ¥­æ©Ÿæœƒã€‚
            </p>
          </div>
          <div
            class="factor-card bg-white p-6 rounded-xl shadow-md border border-gray-200"
          >
            <h3 class="text-xl font-bold mb-3 text-[#4A6C8B]">
              3. æ–°ç§»æ°‘çš„æŒ‘æˆ°
            </h3>
            <p class="text-gray-600">
              Z ä¸–ä»£ä½œç‚ºåŸå¸‚çš„æ–°ç§»æ°‘ï¼Œå…¶ã€Œé»è‘—åº¦ã€é¡¯è‘—ä½æ–¼é•·æœŸå±…æ°‘ (47% vs.
              63%)ã€‚åŸå¸‚éœ€è¦å¹«åŠ©ä»–å€‘å»ºç«‹æ­¸å±¬æ„Ÿï¼Œå¦å‰‡å°‡é¢è‡¨äººæ‰æµå¤±çš„é¢¨éšªã€‚
            </p>
          </div>
        </div>
      </section>

      <hr class="my-20 md:my-24 border-gray-200" />

      <section id="insights" class="scroll-mt-24">
        <div class="text-center mb-12">
          <h2
            class="text-3xl md:text-4xl font-bold text-[#3E5C76] mb-4 text-balance"
          >
            çµ¦æœªä¾†åŸå¸‚çš„å•Ÿç¤º
          </h2>
          <p class="max-w-3xl mx-auto text-gray-600 text-balance">
            Gensler
            çš„å ±å‘Šç‚ºåŸå¸‚æ²»ç†è€…æä¾›äº†å››å¤§æˆ°ç•¥æ–¹å‘ï¼Œå¼·èª¿å¾ç¡¬é«”å»ºè¨­è½‰å‘ã€Œæƒ…æ„ŸåŸºç¤è¨­æ–½ã€çš„åŸ¹é¤Šã€‚
          </p>
        </div>
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
          <div
            class="bg-white p-8 rounded-xl shadow-md border border-gray-200 text-center"
          >
            <div class="text-5xl mb-4">ğŸ›ï¸</div>
            <h3 class="text-xl font-bold mb-2 text-[#3E5C76]">æƒ…æ„ŸåŸºç¤è¨­æ–½</h3>
            <p class="text-gray-600">
              æŠ•è³‡æ–¼èƒ½åŸ¹é¤Šç¤¾ç¾¤æ„Ÿã€æ¿€ç™¼è‡ªè±ªæ„Ÿçš„å…¬å…±ç©ºé–“èˆ‡æ–‡åŒ–é«”é©—ï¼Œå…¶é‡è¦æ€§ä¸äºæ–¼é“è·¯å’Œæ©‹æ¨‘ã€‚
            </p>
          </div>
          <div
            class="bg-white p-8 rounded-xl shadow-md border border-gray-200 text-center"
          >
            <div class="text-5xl mb-4">ğŸ§©</div>
            <h3 class="text-xl font-bold mb-2 text-[#3E5C76]">
              è§£æ±ºæ–°ç§»æ°‘å›°å¢ƒ
            </h3>
            <p class="text-gray-600">
              åŸå¸‚éœ€åˆ¶å®šç­–ç•¥å¹«åŠ©æ–°å±…æ°‘ï¼ˆç‰¹åˆ¥æ˜¯å¹´è¼•äººï¼‰èå…¥ç¤¾ç¾¤ï¼Œå°‡ä»–å€‘å¾éå®¢è½‰è®Šç‚ºå…¬æ°‘ã€‚
            </p>
          </div>
          <div
            class="bg-white p-8 rounded-xl shadow-md border border-gray-200 text-center"
          >
            <div class="text-5xl mb-4">âš–ï¸</div>
            <h3 class="text-xl font-bold mb-2 text-[#3E5C76]">è¶…è¶Šå¯è² æ“”æ€§</h3>
            <p class="text-gray-600">
              ä½ç”Ÿæ´»æˆæœ¬èƒ½å¸å¼•äººï¼Œä½†ç„¡æ³•ç•™ä½äººã€‚åŸå¸‚ä¸èƒ½å–®é ã€Œä¾¿å®œã€ä¾†è³¼è²·å¿ èª åº¦ï¼Œæƒ…æ„Ÿé€£çµæ‰æ˜¯é—œéµã€‚
            </p>
          </div>
          <div
            class="bg-white p-8 rounded-xl shadow-md border border-gray-200 text-center"
          >
            <div class="text-5xl mb-4">ğŸ‰</div>
            <h3 class="text-xl font-bold mb-2 text-[#3E5C76]">
              æ“æŠ±ã€Œç„¡èŠçš„åç¾©è©ã€
            </h3>
            <p class="text-gray-600">
              å‰µé€ ä¸€å€‹å……æ»¿æ´»åŠ›ã€å¤šå…ƒå’Œé©šå–œçš„åŸå¸‚é«”é©—ï¼Œæ˜¯ç•™ä½ä¸‹ä¸€ä»£äººæ‰çš„æ ¸å¿ƒç­–ç•¥ã€‚
            </p>
          </div>
        </div>
      </section>
    </main>

    <footer class="bg-gray-800 text-white mt-24">
      <div class="container mx-auto px-6 py-8 text-center">
        <p>
          æœ¬é é¢å…§å®¹æ ¹æ“š
          <a
            href="https://www.gensler.com/research-insight/city-pulse-2025-the-magnetic-city"
            target="_blank"
            rel="noopener noreferrer"
            class="underline hover:text-gray-300"
            >Gensler Research Instituteã€ŠCity Pulse 2025: The Magnetic Cityã€‹</a
          >å ±å‘Šè£½ä½œã€‚
        </p>
        <p class="text-sm text-gray-400 mt-2">
          è©²ç ”ç©¶èª¿æŸ¥äº†å…¨çƒ65å€‹ä¸»è¦åŸå¸‚çš„è¶…é33,000åå±…æ°‘ã€‚
        </p>
      </div>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const citiesData = [
          {
            rank: 1,
            name: "å°åŒ—",
            country: "å°ç£",
            percentage: 85,
            attraction: 68,
            coords: [25.033, 121.5654],
            description:
              "å°åŒ—ä»¥é©šäººçš„85%èŸ¬è¯æ¦œé¦–ï¼ŒåŒæ™‚åœ¨å¸å¼•åŠ›(68%)å’Œé»è‘—åº¦ä¸Šå‡è¡¨ç¾å„ªç•°ï¼Œæ˜¯å…¸å‹çš„ã€Œç£åŠ›ä¹‹åŸã€ã€‚å…¶å“è¶Šè¡¨ç¾æ­¸åŠŸæ–¼ä¸–ç•Œç´šçš„ä¾¿åˆ©å…¬å…±äº¤é€šã€æ¥µé«˜çš„æ²»å®‰æ°´å¹³å’Œå……æ»¿æ´»åŠ›çš„è¡—é ­å··å°¾ï¼Œå®Œç¾è©®é‡‹äº†ã€Œä¸æ„Ÿåˆ°ç„¡èŠã€å’Œã€Œæœ‰å®¶çš„æ„Ÿè¦ºã€ã€‚",
          },
          {
            rank: 2,
            name: "é¦–çˆ¾",
            country: "éŸ“åœ‹",
            percentage: 82,
            attraction: 70,
            coords: [37.5665, 126.978],
            description:
              "ä½œç‚ºéŸ“åœ‹çš„å¿ƒè‡Ÿï¼Œé¦–çˆ¾æ˜¯å¦ä¸€åº§å¼·å¤§çš„ã€Œç£åŠ›ä¹‹åŸã€ã€‚å®ƒå°‡è¶…ç¾ä»£ç§‘æŠ€èˆ‡æ·±åšæ­·å²åº•è˜Šç„¡ç¸«èåˆã€‚å¾ç¹è¯çš„è³¼ç‰©å€åˆ°éœè¬çš„å¤å®®ï¼Œé¦–çˆ¾çš„å¤šå…ƒé«”é©—ä½¿å…¶å±…æ°‘ã€Œä¸æ„Ÿåˆ°ç„¡èŠã€ï¼Œå¼·çƒˆçš„åœ‹å®¶èªåŒæ„Ÿèˆ‡åŸå¸‚è‡ªè±ªæ„Ÿä¹Ÿæ˜¯å‡èšäººå¿ƒçš„é‡è¦åŠ›é‡ã€‚",
          },
          {
            rank: 3,
            name: "æ–°åŠ å¡",
            country: "æ–°åŠ å¡",
            percentage: 80,
            attraction: 81,
            coords: [1.3521, 103.8198],
            description:
              "æ–°åŠ å¡æ˜¯å¸å¼•åŠ›(81%)æœ€é«˜çš„åŸå¸‚ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯ä¸€åº§ã€Œç£åŠ›ä¹‹åŸã€ã€‚ä½œç‚ºä¸€å€‹é«˜åº¦çµ„ç¹”åŒ–ã€ä»¥å®‰å…¨å’Œç¶ åŒ–èåçš„èŠ±åœ’åŸå¸‚åœ‹å®¶ï¼Œå®ƒç‚ºå±…æ°‘æä¾›äº†æ¥µé«˜çš„ç”Ÿæ´»å“è³ªå’Œã€Œå®¶çš„æ„Ÿè¦ºã€ã€‚å ±å‘Šç‰¹åˆ¥æŒ‡å‡ºï¼Œä½œç‚ºä¸€å€‹åŸé‚¦åœ‹å®¶ï¼Œæ–°åŠ å¡æ˜¯å…¶åœ‹æ°‘åœ¨åœ‹å…§çš„ã€Œå”¯ä¸€åŸå¸‚é¸æ“‡ã€ï¼Œé€™æœ¬èº«å°±æ˜¯ä¸€å€‹å¼·å¤§çš„ç•™å­˜å› ç´ ã€‚",
          },
          {
            rank: 4,
            name: "æ…•å°¼é»‘",
            country: "å¾·åœ‹",
            percentage: 79,
            attraction: 72,
            coords: [48.1351, 11.582],
            description:
              "æ…•å°¼é»‘æ˜¯æ¦œå–®ä¸Šæ’åæœ€é«˜çš„æ­æ´²åŸå¸‚ï¼Œä¹Ÿæ˜¯ä¸€åº§ã€Œç£åŠ›ä¹‹åŸã€ã€‚å®ƒä¸åƒ…æ˜¯å¾·åœ‹çš„ç¶“æ¿Ÿé‡é®ï¼Œæ›´ä»¥é«˜å“è³ªçš„ç”Ÿæ´»ç’°å¢ƒã€è±å¯Œçš„æ–‡åŒ–æ´»å‹•å’Œè¦ªè¿‘è‡ªç„¶çš„åœ°ç†ä½ç½®è‘—ç¨±ã€‚ç¶“æ¿Ÿæ´»åŠ›èˆ‡ä¼‘é–’ç”Ÿæ´»çš„å®Œç¾å¹³è¡¡ï¼Œè®“å±…æ°‘ç”¢ç”Ÿå¼·çƒˆçš„æ­¸å±¬æ„Ÿå’Œè‡ªè±ªæ„Ÿã€‚",
          },
          {
            rank: 5,
            name: "è’™ç‰¹é›·",
            country: "å¢¨è¥¿å“¥",
            percentage: 78,
            attraction: 45,
            coords: [25.6866, -100.3161],
            description:
              "è’™ç‰¹é›·æ˜¯ã€Œæ½›åŠ›ä¹‹åŸã€çš„çµ•ä½³ç¯„ä¾‹ã€‚å„˜ç®¡å…¶å…¨çƒå¸å¼•åŠ›(45%)ç›¸å°è¼ƒä½ï¼Œä½†å…¶å±…æ°‘é»è‘—åº¦æ¥µé«˜ã€‚é€™è­‰æ˜äº†å¼·çƒˆçš„åœ°åŸŸæ–‡åŒ–ã€ç·Šå¯†çš„ç¤¾ç¾¤è¯ç¹«å’Œå……æ»¿æ´»åŠ›çš„å…¬å…±ç”Ÿæ´»ï¼Œåœ¨å»ºç«‹å±…æ°‘æ­¸å±¬æ„Ÿæ–¹é¢ç™¼æ®äº†è¶…è¶Šå‚³çµ±ç¶“æ¿ŸæŒ‡æ¨™çš„é—œéµä½œç”¨ã€‚",
          },
          {
            rank: 6,
            name: "å¢¨è¥¿å“¥åŸ",
            country: "å¢¨è¥¿å“¥",
            percentage: 77,
            attraction: 55,
            coords: [19.4326, -99.1332],
            description:
              "é€™åº§æ‹‰ä¸ç¾æ´²å¤§éƒ½æœƒæ“æœ‰ä¸–ç•Œç´šçš„åšç‰©é¤¨ã€è±å¯Œçš„æ­·å²éºç”¢å’Œç„¡èˆ‡å€«æ¯”çš„ç¾é£Ÿæ™¯è§€ï¼Œç‚ºå±…æ°‘æä¾›äº†æºæºä¸æ–·çš„æ–‡åŒ–æ»‹é¤Šï¼Œè®“ä»–å€‘ã€Œä¸æ„Ÿåˆ°ç„¡èŠã€ã€‚æ·±åšçš„æ–‡åŒ–åº•è˜Šå’Œå¼·çƒˆçš„æ°‘æ—è‡ªè±ªæ„Ÿï¼Œæ˜¯å…¶å±…æ°‘é¸æ“‡é•·ä¹…ç•™ä¸‹çš„é‡è¦æƒ…æ„ŸåŸºçŸ³ã€‚",
          },
          {
            rank: 7,
            name: "å€«æ•¦",
            country: "è‹±åœ‹",
            percentage: 75,
            attraction: 78,
            coords: [51.5072, -0.1276],
            description:
              "å€«æ•¦æ˜¯ä¸€åº§å…¸å‹çš„ã€Œç£åŠ›ä¹‹åŸã€ï¼Œå¸å¼•åŠ›(78%)èˆ‡é»è‘—åº¦(75%)é›™é«˜ã€‚ä½œç‚ºå…¨çƒé‡‘èèˆ‡æ–‡åŒ–ä¸­å¿ƒï¼Œå…¶é»è‘—åº¦æºæ–¼ç„¡å¯æ¯”æ“¬çš„å¤šå…ƒæ€§èˆ‡æ´»åŠ›ã€‚ä¸–ç•Œé ‚ç´šçš„åŠ‡é™¢ã€åšç‰©é¤¨å’Œå¤šå…ƒåŒ–çš„ç¤¾å€ï¼Œä½¿å…¶æˆç‚ºä¸€å€‹æ°¸é å……æ»¿æ–°é®®æ„Ÿçš„åŸå¸‚ã€‚",
          },
          {
            rank: 8,
            name: "æ³¢å“¥å¤§",
            country: "å“¥å€«æ¯”äº",
            percentage: 74,
            attraction: 39,
            coords: [4.711, -74.0721],
            description:
              "èˆ‡è’™ç‰¹é›·ç›¸ä¼¼ï¼Œæ³¢å“¥å¤§ä¹Ÿæ˜¯ä¸€åº§ã€Œæ½›åŠ›ä¹‹åŸã€ã€‚è¿‘å¹´ä¾†åœ¨åŸå¸‚æ›´æ–°ã€å…¬å…±ç©ºé–“ç‡Ÿé€ å’Œæ–‡åŒ–ç™¼å±•æ–¹é¢å–å¾—äº†é¡¯è‘—é€²æ­¥ã€‚å…¶å‰µæ–°çš„å…¬å…±äº¤é€šç³»çµ±ã€éå¸ƒåŸå¸‚çš„è‡ªè¡Œè»Šé“ç¶²çµ¡å’Œè“¬å‹ƒç™¼å±•çš„è—è¡“å ´æ™¯ï¼Œæå‡äº†å±…æ°‘çš„ç”Ÿæ´»å“è³ªå’ŒåŸå¸‚è‡ªè±ªæ„Ÿã€‚",
          },
          {
            rank: 9,
            name: "é›ªæ¢¨",
            country: "æ¾³æ´²",
            percentage: 73,
            attraction: 75,
            coords: [-33.8688, 151.2093],
            description:
              "é›ªæ¢¨ä»¥å…¶æ¨™èªŒæ€§çš„æµ·æ¸¯æ™¯è§€ã€å®œäººçš„æ°£å€™å’Œè¼•é¬†æˆ¶å¤–çš„ç”Ÿæ´»æ–¹å¼è€Œèåï¼Œæ˜¯ä¸€åº§ã€Œç£åŠ›ä¹‹åŸã€ã€‚å±…æ°‘èƒ½å¤ åœ¨ç¹è¯çš„éƒ½å¸‚ç”Ÿæ´»èˆ‡ç¾éº—çš„è‡ªç„¶é¢¨å…‰ä¹‹é–“è¼•é¬†åˆ‡æ›ï¼Œé€™ç¨®å¹³è¡¡æ¥µå¤§åœ°æå‡äº†å¹¸ç¦æ„Ÿå’Œã€Œå®¶çš„æ„Ÿè¦ºã€ã€‚",
          },
          {
            rank: 10,
            name: "ä¸Šæµ·",
            country: "ä¸­åœ‹",
            percentage: 72,
            attraction: 65,
            coords: [31.2304, 121.4737],
            description:
              "ä½œç‚ºä¸­åœ‹çš„ç¶“æ¿Ÿä¸­å¿ƒï¼Œä¸Šæµ·ä»¥å…¶å¿«é€Ÿçš„ç™¼å±•ã€é«˜æ•ˆçš„ç®¡ç†å’Œä¸æ–·è®ŠåŒ–çš„å¤©éš›ç·šè€Œä»¤å±…æ°‘è‡ªè±ªã€‚é€™åº§åŸå¸‚èåˆäº†å‚³çµ±èˆ‡ç¾ä»£é­…åŠ›ï¼Œæä¾›äº†è±å¯Œå¤šå…ƒçš„ç”Ÿæ´»é«”é©—ï¼Œå…¶æ´»åŠ›èˆ‡æ©Ÿé‡ä½¿å…¶å±…æ°‘ã€Œä¸æ„Ÿåˆ°ç„¡èŠã€ï¼Œä¸¦å°æœªä¾†å……æ»¿ä¿¡å¿ƒã€‚",
          },
          {
            rank: 11,
            name: "æ±äº¬",
            country: "æ—¥æœ¬",
            percentage: 71,
            attraction: 71,
            coords: [35.6895, 139.6917],
            description:
              "æ±äº¬æ˜¯å¦ä¸€åº§å¸å¼•åŠ›èˆ‡é»è‘—åº¦é›™é«˜çš„ã€Œç£åŠ›ä¹‹åŸã€ã€‚å…¶ç„¡èˆ‡å€«æ¯”çš„å…¬å…±å®‰å…¨ã€æ¥µè‡´çš„ä¾¿åˆ©æ€§å’Œæ·±æ¤æ–¼æ—¥å¸¸çš„ç²¾ç·»æ–‡åŒ–ï¼Œç‚ºå±…æ°‘æä¾›äº†ç©©å®šè€Œè±å¯Œçš„ç”Ÿæ´»é«”é©—ã€‚å¾ç±³å…¶æ—æ˜Ÿç´šé¤å»³åˆ°éš±è—åœ¨å··å¼„ä¸­çš„å±…é…’å±‹ï¼Œæ±äº¬ç¸½èƒ½æä¾›æ–°çš„æ¢ç´¢æ¨‚è¶£ã€‚",
          },
          {
            rank: 12,
            name: "æ›¼è°·",
            country: "æ³°åœ‹",
            percentage: 70,
            attraction: 60,
            coords: [13.7563, 100.5018],
            description:
              "æ›¼è°·ä»¥å…¶å……æ»¿æ´»åŠ›çš„è¡—é ­ç”Ÿæ´»ã€ç„¡èˆ‡å€«æ¯”çš„ç¾é£Ÿå’Œç›¸å°è¼ƒä½çš„ç”Ÿæ´»æˆæœ¬è€Œèåã€‚é€™åº§åŸå¸‚çš„æ··äº‚èˆ‡é­…åŠ›ä¸¦å­˜ï¼Œç‚ºå±…æ°‘æä¾›äº†æ¥µå…¶è±å¯Œçš„ç”Ÿæ´»é«”é©—ï¼Œå……åˆ†é«”ç¾äº†ã€Œä¸æ„Ÿåˆ°ç„¡èŠã€çš„ç‰¹è³ªã€‚",
          },
          {
            rank: 13,
            name: "è–åœ°ç‰™å“¥",
            country: "æ™ºåˆ©",
            percentage: 69,
            attraction: 48,
            coords: [-33.4489, -70.6693],
            description:
              "è–åœ°ç‰™å“¥èƒŒé å®‰åœ°æ–¯å±±è„ˆï¼Œæ“æœ‰å¾—å¤©ç¨åšçš„åœ°ç†ä½ç½®ã€‚è¿‘å¹´ä¾†ï¼Œå…¶åœ¨æ–‡åŒ–è—è¡“é ˜åŸŸçš„ç™¼å±•è¿…é€Ÿï¼ŒåŠ ä¸Šç©©å®šçš„ç¶“æ¿Ÿç’°å¢ƒï¼Œä½¿å…¶æˆç‚ºæ‹‰ä¸ç¾æ´²ä¸€å€‹å…¼å…·ç”Ÿæ´»å“è³ªèˆ‡ç™¼å±•æ©Ÿæœƒçš„åŸå¸‚ã€‚",
          },
          {
            rank: 14,
            name: "ç´ç´„",
            country: "ç¾åœ‹",
            percentage: 68,
            attraction: 79,
            coords: [40.7128, -74.006],
            description:
              "ç´ç´„æ˜¯å…¸å‹çš„ã€Œå‹•ç›ªä¹‹åŸã€ã€‚å®ƒæ“æœ‰å…¨çƒé ‚å°–çš„å¸å¼•åŠ›(79%)ï¼Œå¸å¼•è‘—ä¸–ç•Œå„åœ°çš„äººæ‰å‰ä¾†è¿½å¤¢ã€‚ç„¶è€Œï¼Œå…¶é»è‘—åº¦(68%)ç›¸å°è¼ƒä½ï¼Œé«˜æ˜‚çš„ç”Ÿæ´»æˆæœ¬å’Œç·Šå¼µçš„ç”Ÿæ´»ç¯€å¥ï¼Œä½¿å¾—è¨±å¤šäººå°‡å…¶è¦–ç‚ºäººç”Ÿçš„è·³æ¿è€Œéçµ‚é»ã€‚",
          },
          {
            rank: 15,
            name: "è–ä¿ç¾…",
            country: "å·´è¥¿",
            percentage: 67,
            attraction: 42,
            coords: [-23.5505, -46.6333],
            description:
              "ä½œç‚ºå—åŠçƒæœ€å¤§çš„åŸå¸‚ï¼Œè–ä¿ç¾…æ˜¯å·´è¥¿çš„ç¶“æ¿Ÿèˆ‡æ–‡åŒ–ä¸­å¿ƒã€‚å…¶å¤šå…ƒçš„ç§»æ°‘æ–‡åŒ–ã€è“¬å‹ƒçš„è—è¡“å ´æ™¯å’Œè±å¯Œçš„å¤œç”Ÿæ´»ï¼Œç‚ºå±…æ°‘æä¾›äº†å¼·çƒˆçš„æ–‡åŒ–èªåŒæ„Ÿå’Œæ­¸å±¬æ„Ÿã€‚",
          },
          {
            rank: 16,
            name: "æœæ‹œ",
            country: "é˜¿è¯é…‹",
            percentage: 66,
            attraction: 74,
            coords: [25.276987, 55.296249],
            description:
              "æœæ‹œå’Œç´ç´„ä¸€æ¨£ï¼ŒåŒå±¬ã€Œå‹•ç›ªä¹‹åŸã€ã€‚å®ƒä»¥å…¶æœªä¾†çš„é¡˜æ™¯ã€å•†æ¥­æ©Ÿæœƒå’Œå¥¢è¯çš„ç”Ÿæ´»æ–¹å¼å¸å¼•è‘—å…¨çƒäººæ‰ï¼Œä½†å…¶å±…æ°‘é»è‘—åº¦ç›¸å°è¼ƒä½ï¼Œå¤–ç±äººå£«ä½”å¤šæ•¸çš„äººå£çµæ§‹ä½¿å…¶ç¤¾ç¾¤é€£çµè¼ƒç‚ºçŸ­æš«ã€‚",
          },
          {
            rank: 17,
            name: "ä¼‘å£«é “",
            country: "ç¾åœ‹",
            percentage: 65,
            attraction: 58,
            coords: [29.7604, -95.3698],
            description:
              "ä¼‘å£«é “æ˜¯ç¾åœ‹æœ€å¤šå…ƒåŒ–çš„åŸå¸‚ä¹‹ä¸€ï¼Œä»¥å…¶å‹å¥½çš„æ°›åœã€è¼ƒä½çš„ç”Ÿæ´»æˆæœ¬å’Œå¼·å‹çš„å°±æ¥­å¸‚å ´è€Œè‘—ç¨±ã€‚å…¶å¤šå…ƒæ–‡åŒ–èåˆçš„ç¤¾å€ç‚ºå±…æ°‘æä¾›äº†å¼·çƒˆçš„æ­¸å±¬æ„Ÿã€‚",
          },
          {
            rank: 18,
            name: "å·´é»",
            country: "æ³•åœ‹",
            percentage: 64,
            attraction: 76,
            coords: [48.8566, 2.3522],
            description:
              "å·´é»æ˜¯å¦ä¸€åº§ã€Œå‹•ç›ªä¹‹åŸã€ã€‚ç„¡å¯å¦èªï¼Œå®ƒæ“æœ‰æ¥µé«˜çš„å…¨çƒå¸å¼•åŠ›ï¼Œä½†å…¶å±…æ°‘é»è‘—åº¦å»åœ¨æ¦œå–®ä¸­åå¾Œã€‚é€™åæ˜ å‡ºåœ¨æµªæ¼«å…‰ç’°ä¹‹ä¸‹ï¼Œæœ¬åœ°å±…æ°‘å¯èƒ½é¢è‡¨è‘—ç”Ÿæ´»æˆæœ¬ã€åŸå¸‚æ“æ“ ç­‰ç¾å¯¦æŒ‘æˆ°ã€‚",
          },
          {
            rank: 19,
            name: "æ´›æ‰ç£¯",
            country: "ç¾åœ‹",
            percentage: 63,
            attraction: 69,
            coords: [34.0522, -118.2437],
            description:
              "æ´›æ‰ç£¯çš„å¸å¼•åŠ›åœ¨æ–¼å…¶å‰µæ„ç”¢æ¥­å’Œå¤šå…ƒæ–‡åŒ–ï¼Œä½†äº¤é€šã€ä½æˆ¿ç­‰å•é¡Œä¹Ÿå½±éŸ¿äº†å±…æ°‘çš„é•·æœŸç•™å­˜æ„é¡˜ã€‚å®ƒæ˜¯ä¸€å€‹å……æ»¿æ©Ÿé‡ä½†ä¹Ÿå……æ»¿æŒ‘æˆ°çš„åŸå¸‚ã€‚",
          },
          {
            rank: 20,
            name: "èŠåŠ å“¥",
            country: "ç¾åœ‹",
            percentage: 62,
            attraction: 64,
            coords: [41.8781, -87.6298],
            description:
              "èŠåŠ å“¥ä»¥å…¶å£¯è§€çš„å»ºç¯‰ã€ä¸–ç•Œç´šçš„åšç‰©é¤¨å’Œå‹™å¯¦çš„åŸå¸‚ç²¾ç¥è€Œèåã€‚å®ƒåœ¨å¸å¼•åŠ›å’Œé»è‘—åº¦ä¸Šè¡¨ç¾å‡è¡¡ï¼Œä½†ä»æœ‰æå‡ç©ºé–“ï¼Œä»¥æ›´å¥½åœ°å°‡å…¶æ–‡åŒ–è³‡ç”¢è½‰åŒ–ç‚ºå±…æ°‘çš„æ·±å±¤æƒ…æ„Ÿé€£çµã€‚",
          },
        ];

        let stickyChart, attractionStickinessChart;
        let currentCityIndex = 0;

        const stickyChartCanvas = document.getElementById("stickyCitiesChart");
        const attractionStickinessCanvas = document.getElementById(
          "attractionStickinessChart"
        );
        const cityNameEl = document.getElementById("cityName");
        const cityRankEl = document.getElementById("cityRank");
        const cityPercentageEl = document.getElementById("cityPercentage");
        const cityDescriptionEl = document.getElementById("cityDescription");
        const mapDiv = document.getElementById("map");

        function createStickyChart() {
          const ctx = stickyChartCanvas.getContext("2d");
          stickyChart = new Chart(ctx, {
            type: "bar",
            data: {
              labels: citiesData.map((c) => `${c.rank}. ${c.name}`),
              datasets: [
                {
                  label: "ã€Œä¸å¤ªå¯èƒ½æ¬é›¢ã€å±…æ°‘æ¯”ä¾‹ (%)",
                  data: citiesData.map((c) => c.percentage),
                  backgroundColor: citiesData.map((_, i) =>
                    i === currentCityIndex ? "#4A6C8B" : "#C5D4E2"
                  ),
                  borderColor: citiesData.map((_, i) =>
                    i === currentCityIndex ? "#3E5C76" : "#A9B9C9"
                  ),
                  borderWidth: 2,
                  borderRadius: 4,
                },
              ],
            },
            options: {
              indexAxis: "y",
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: function (context) {
                      return ` ${context.raw}% çš„å±…æ°‘ä¸å¤ªå¯èƒ½æ¬é›¢`;
                    },
                  },
                },
              },
              scales: {
                x: { beginAtZero: true, max: 100, grid: { color: "#E5E7EB" } },
                y: { grid: { display: false } },
              },
              onClick: (event, elements) => {
                if (elements.length > 0) {
                  updateContent(elements[0].index);
                }
              },
            },
          });
        }

        function createAttractionStickinessChart() {
          const ctx = attractionStickinessCanvas.getContext("2d");
          const averageAttraction =
            citiesData.map((c) => c.attraction).reduce((a, b) => a + b, 0) /
            citiesData.length;
          const averageStickiness =
            citiesData.map((c) => c.percentage).reduce((a, b) => a + b, 0) /
            citiesData.length;

          attractionStickinessChart = new Chart(ctx, {
            type: "scatter",
            data: {
              datasets: [
                {
                  label: "å…¨çƒåŸå¸‚",
                  data: citiesData.map((c) => ({
                    x: c.attraction,
                    y: c.percentage,
                    label: c.name,
                  })),
                  backgroundColor: "#4A6C8B",
                  pointRadius: 6,
                  pointHoverRadius: 9,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: { display: false },
                tooltip: {
                  callbacks: {
                    label: function (context) {
                      const d = context.raw;
                      return `${d.label}: (å¸å¼•åŠ›: ${d.x}, é»è‘—åº¦: ${d.y})`;
                    },
                  },
                },
                ...(typeof window.chartjs_plugin_annotation !== "undefined" && {
                  annotation: {
                    annotations: {
                      xLine: {
                        type: "line",
                        xMin: averageAttraction,
                        xMax: averageAttraction,
                        borderColor: "rgba(0,0,0,0.2)",
                        borderWidth: 2,
                        borderDash: [6, 6],
                      },
                      yLine: {
                        type: "line",
                        yMin: averageStickiness,
                        yMax: averageStickiness,
                        borderColor: "rgba(0,0,0,0.2)",
                        borderWidth: 2,
                        borderDash: [6, 6],
                      },
                      magneticLabel: {
                        type: "label",
                        xValue: averageAttraction + 2,
                        yValue: averageStickiness + 2,
                        content: "ç£åŠ›ä¹‹åŸ",
                        color: "rgba(0,0,0,0.3)",
                        font: { size: 12 },
                        position: "start",
                      },
                      volatileLabel: {
                        type: "label",
                        xValue: averageAttraction + 2,
                        yValue: averageStickiness - 2,
                        content: "å‹•ç›ªä¹‹åŸ",
                        color: "rgba(0,0,0,0.3)",
                        font: { size: 12 },
                        position: "start",
                        yAdjust: -10,
                      },
                      untappedLabel: {
                        type: "label",
                        xValue: averageAttraction - 2,
                        yValue: averageStickiness + 2,
                        content: "æ½›åŠ›ä¹‹åŸ",
                        color: "rgba(0,0,0,0.3)",
                        font: { size: 12 },
                        position: "end",
                      },
                      stagnantLabel: {
                        type: "label",
                        xValue: averageAttraction - 2,
                        yValue: averageStickiness - 2,
                        content: "åœæ»¯ä¹‹åŸ",
                        color: "rgba(0,0,0,0.3)",
                        font: { size: 12 },
                        position: "end",
                        yAdjust: -10,
                      },
                    },
                  },
                }),
              },
              scales: {
                x: {
                  type: "linear",
                  position: "bottom",
                  title: {
                    display: true,
                    text: "å¸å¼•åŠ›åˆ†æ•¸ (Attraction Score)",
                  },
                  min: 30,
                  max: 90,
                },
                y: {
                  title: {
                    display: true,
                    text: "é»è‘—åº¦åˆ†æ•¸ (Stickiness Score)",
                  },
                  min: 60,
                  max: 90,
                },
              },
            },
          });
        }

        function createMap() {
          const mapData = [
            {
              type: "scattergeo",
              lon: citiesData.map((c) => c.coords[1]),
              lat: citiesData.map((c) => c.coords[0]),
              text: citiesData.map(
                (c) => `${c.rank}. ${c.name}: ${c.percentage}%`
              ),
              mode: "markers",
              marker: {
                size: citiesData.map((_, i) =>
                  i === currentCityIndex ? 20 : 10
                ),
                color: citiesData.map((_, i) =>
                  i === currentCityIndex ? "#D64933" : "#4A6C8B"
                ),
                opacity: 0.8,
                line: { color: "white", width: 1 },
              },
            },
          ];

          const layout = {
            geo: {
              projection: { type: "natural earth" },
              showland: true,
              landcolor: "#F0F4F8",
              showocean: true,
              oceancolor: "#FFFFFF",
              bgcolor: "#FDFBF8",
              countrycolor: "#BCCCDC",
              showcountries: true,
              showsubunits: true,
              subunitcolor: "#BCCCDC",
            },
            margin: { l: 0, r: 0, t: 0, b: 0 },
            paper_bgcolor: "#FDFBF8",
          };

          Plotly.newPlot(mapDiv, mapData, layout, {
            responsive: true,
            displayModeBar: false,
          });
        }

        function updateContent(index) {
          currentCityIndex = index;
          const city = citiesData[index];

          cityNameEl.textContent = city.name;
          cityRankEl.textContent = city.rank;
          cityPercentageEl.textContent = `${city.percentage}%`;
          cityDescriptionEl.innerHTML = `<p>${city.description}</p>`;

          stickyChart.data.datasets[0].backgroundColor = citiesData.map(
            (_, i) => (i === index ? "#4A6C8B" : "#C5D4E2")
          );
          stickyChart.data.datasets[0].borderColor = citiesData.map((_, i) =>
            i === index ? "#3E5C76" : "#A9B9C9"
          );
          stickyChart.update();

          Plotly.update(
            mapDiv,
            {
              "marker.size": [
                citiesData.map((_, i) => (i === index ? 20 : 10)),
              ],
              "marker.color": [
                citiesData.map((_, i) => (i === index ? "#D64933" : "#4A6C8B")),
              ],
            },
            {},
            [0]
          );
        }

        function setupNavObserver() {
          const sections = document.querySelectorAll("section[id]");
          const navLinks = document.querySelectorAll(".nav-button");

          const observer = new IntersectionObserver(
            (entries) => {
              entries.forEach((entry) => {
                if (entry.isIntersecting) {
                  navLinks.forEach((link) => {
                    link.classList.remove("active");
                    if (
                      link.getAttribute("href").substring(1) === entry.target.id
                    ) {
                      link.classList.add("active");
                    }
                  });
                }
              });
            },
            { rootMargin: "-50% 0px -50% 0px" }
          );

          sections.forEach((section) => observer.observe(section));

          navLinks.forEach((link) => {
            link.addEventListener("click", (e) => {
              e.preventDefault();
              document
                .querySelector(link.getAttribute("href"))
                .scrollIntoView({ behavior: "smooth" });
            });
          });
        }

        // Register annotation plugin if available
        if (typeof window.chartjs_plugin_annotation !== "undefined") {
          Chart.register(window.chartjs_plugin_annotation);
        }

        createStickyChart();
        createAttractionStickinessChart();
        createMap();
        updateContent(0);
        setupNavObserver();
      });
    </script>
  </body>
</html>
